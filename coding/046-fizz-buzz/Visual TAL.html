<!DOCTYPE html>
<!-- saved from url=(0041)https://wiki.tcl-lang.org/page/Visual+TAL -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Tclers wiki">
<meta name="author" content="">
<link rel="icon" href="https://wiki.tcl-lang.org/img/favicon.ico">
<title>Visual TAL</title>

<link rel="stylesheet" href="./Visual TAL_files/bootstrap.min.css">
<link rel="stylesheet" href="./Visual TAL_files/nikit.css" type="text/css">
<link rel="stylesheet" href="./Visual TAL_files/sh_style.css" type="text/css">
<link rel="stylesheet" href="./Visual TAL_files/theme.bootstrap_3.min.css" type="text/css">
<script src="./Visual TAL_files/clipboard.min.js"></script>
<style>body.tablesorter-disableSelection { -ms-user-select: none; -moz-user-select: -moz-none;-khtml-user-select: none; -webkit-user-select: none; user-select: none; }.tablesorter-resizable-container { position: relative; height: 1px; }.tablesorter-resizable-handle { position: absolute; display: inline-block; width: 8px;top: 1px; cursor: ew-resize; z-index: 3; user-select: none; -moz-user-select: none; }</style></head>
<body onload="sh_highlightDocument(); nikitUser();">
<nav class="navbar navbar-fixed-top navbar-inverse">
<div class="container">
<div class="navbar-header">
<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<ul class="nav navbar-nav">
<li class="dropdown">
<a class="dropdown-toggle" data-toggle="dropdown" href="https://wiki.tcl-lang.org/page/Visual+TAL#">&nbsp;Tcler's Wiki<span class="caret"></span></a>
<ul class="dropdown-menu scrollable-menu" role="menu"><li><a href="https://wiki.tcl-lang.org/welcome">Home</a></li>
<li><a rel="nofollow" href="https://wiki.tcl-lang.org/recent">Changes</a></li>
<li><a rel="nofollow" href="https://wiki.tcl-lang.org/_random">Random page</a></li>
<li><a rel="nofollow" href="https://wiki.tcl-lang.org/_new">New page</a></li>
</ul>
</li>
</ul>
</div>
<div class="collapse navbar-collapse" id="myNavbar">
<ul class="nav navbar-nav">
<li class="dropdown" id="li_idPageEdit" style="display:none">
<a class="dropdown-toggle" data-toggle="dropdown" href="https://wiki.tcl-lang.org/page/Visual+TAL#"><span id="name_idPageEdit">Page</span><span class="caret"></span></a>
<ul class="dropdown-menu scrollable-menu" role="menu"><li><a rel="nofollow" href="https://wiki.tcl-lang.org/_edit/Visual+TAL?A=1">Comment</a></li>
<li><a rel="nofollow" hidden="true" href="https://wiki.tcl-lang.org/_edit/Visual+TAL">Edit</a></li>
<li><a rel="nofollow" href="https://wiki.tcl-lang.org/_upload/Visual+TAL">Upload</a></li>
<li><a rel="nofollow" href="https://wiki.tcl-lang.org/ref/Visual+TAL">References</a></li>
<li><a rel="nofollow" href="https://wiki.tcl-lang.org/history/Visual+TAL">History</a></li>
</ul>
</li>
<li class="dropdown" id="li_idPageNoEdit" style="display: block;">
<a class="dropdown-toggle" data-toggle="dropdown" href="https://wiki.tcl-lang.org/page/Visual+TAL#"><span id="name_idPageNoEdit">Page</span><span class="caret"></span></a>
<ul class="dropdown-menu scrollable-menu" role="menu"><li><a rel="nofollow" href="https://wiki.tcl-lang.org/ref/Visual+TAL">References</a></li>
<li><a rel="nofollow" href="https://wiki.tcl-lang.org/history/Visual+TAL">History</a></li>
</ul>
</li>
<li><a href="https://wiki.tcl-lang.org/page/Tcl+Tutorial+Lesson+0">Tutorial</a></li>
<li><a href="https://wiki.tcl-lang.org/page/Articles">Articles</a></li>
<li class="dropdown">
<a class="dropdown-toggle" data-toggle="dropdown" href="https://wiki.tcl-lang.org/page/Visual+TAL#">&nbsp;Help<span class="caret"></span></a>
<ul class="dropdown-menu scrollable-menu" role="menu"><li><a rel="nofollow" href="https://wiki.tcl-lang.org/page/Help">Page Markup</a></li>
<li><a rel="nofollow" href="https://wiki.tcl-lang.org/page/How+do+Wiki+Categories+work">Wiki Categories</a></li>
<li><a rel="nofollow" href="https://wiki.tcl-lang.org/page/Contents">Topics</a></li>
<li><a rel="nofollow" target="_blank" href="https://chiselapp.com/user/stevel/repository/nikit/ticket">Report Problems</a></li>
<li><a rel="nofollow" href="https://wiki.tcl-lang.org/privacy">Privacy</a></li>
<li><a rel="nofollow" href="https://wiki.tcl-lang.org/license">License</a></li>
</ul>
</li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
<a class="dropdown-toggle" data-toggle="dropdown" href="https://wiki.tcl-lang.org/page/Visual+TAL#"><span id="name_SMenu">User</span><span class="caret"></span></a>
<ul class="dropdown-menu" id="ul_SMenu"><li><a rel="nofollow" href="https://wiki.tcl-lang.org/_login?U=https://wiki.tcl-lang.org/page/Visual+TAL">Sign in</a></li></ul>
</li>
</ul>
<form class="navbar-form navbar-right" method="post" action="https://wiki.tcl-lang.org/search" id="searchform">
<input name="Q" type="text" class="form-control" placeholder="Search...">
<input type="hidden" name="sites" value="wiki.tcl-lang.org">
</form>
</div>
</div>
</nav>
<div class="container">
<div class="row">
<div class="col-xs-12">
<h2>Visual TAL</h2>
</div>
</div>
<div class="row">
<div class="col-xs-12">
<p class="mkup_p"><a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/Richard+Suchenwirth">Richard Suchenwirth</a> 2013-12-01 - Last night on the Tclers' Chat, <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/Stu">stu</a> challenged me to write a visual emulator for <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/TAL">TAL</a>. Challenge accepted, after some 3 hours here is (another iteration of) the initial code that managed to step (with the &lt;Down&gt; key) through the TAL code emulating <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/hypot">hypot</a>. A day later, the "Run" button was also enabled to, well, run the code (waiting 500 ms between steps, so one can visually follow somewhat), and stop at breakpoints where set.</p><p class="mkup_p">On top you can enter a proc (with fixed name "f"), hit &lt;Return&gt; to get its body dis- and reassembled.</p><p class="mkup_p">In the main window at left you see the TAL source code (ready to <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/assemble">assemble</a>, hopefully) in black, while the <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/disassemble">disassemble</a> code is added as comments in red (just in case <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/dis2asm">dis2asm</a> did something wrong). The yellow highlighting marks the code that will be executed next. The window is editable, and "what you see is what is executed", because the code to execute is fetched directly before execution from the highlighted line.</p><p class="mkup_p">On the right the local variables are displayed (you can edit their values), and below that the current stack.</p><p class="mkup_p"><img class="mkup_img" alt="tal.tcl_002.png" src="./Visual TAL_files/tal.tcl_002.png"></p><p class="mkup_p">Of the 130 TAL instructions, about 50 have been implemented so far (see the function <i class="mkup_i">vtal.eval</i> below). The underlying idea is that you will also be able to edit the displayed <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/TAL">TAL</a> source, and run it again... lots of bells and whistles in planning...</p><p class="mkup_p">Following is the evening edition for 2013-12-03. New feature: set a breakpoint by right-clicking, shows this stop sign <img class="mkup_img" alt="stop.gif" src="./Visual TAL_files/stop.gif">. Delete a breakpoint just like a character :^) It took me a while to get it correct, but finally.. just 10 extra LOC! That's certainly worth it ;^)</p><p class="mkup_p">Disclaimer: While the real <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/TAL">TAL</a> assembler implements <i class="mkup_i">beginCatch</i> and <i class="mkup_i">endCatch</i>, this emulator doesn't yet, so no <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/catch">catch</a> here for the time being... Also missing: <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/dict">dict</a> instructions (will come), <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/array">array</a> instructions (more difficult, as variables are now managed in an array - needs redesign...), <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/TclOO">TclOO</a>, <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/coroutine">coroutine</a>...</p><p class="mkup_p">For the moment, just consider this an educational tool for a subset of Tcl :^) I'll keep the latest <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/tal.tcl">tal.tcl</a> on that page, so you don't need to stitch it together from the various <a class="mkup_a mkup_known" href="https://wiki.tcl-lang.org/page/dis2asm">dis2asm</a> pages.</p><div class="sh_sourceCode"><button class="copybtn btn pull-right" data-clipboard-target="#mkup_code_0" title="Click to copy code snippet to clipboard"><span class="glyphicon glyphicon-copy" aria-hidden="true"></span></button><pre id="mkup_code_0" class="sh_tcl sh_sourceCode"><span class="sh_comment">#!/usr/bin/env tclkit</span>
<span class="sh_comment"># vtal.tcl -- Visual TAL</span>

<a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> thisdir <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/file" class="sh_keyword">file</a> dirname <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/info" class="sh_keyword">info</a> script<span class="sh_symbol">]]</span>
<a href="https://wiki.tcl-lang.org/page/source" class="sh_keyword">source</a> <span class="sh_variable">$thisdir</span><span class="sh_symbol">/</span>tal<span class="sh_number">.</span>tcl
<a href="https://wiki.tcl-lang.org/page/package" class="sh_keyword">package</a> require Tk
<a href="https://wiki.tcl-lang.org/page/image" class="sh_keyword">image</a> create <a href="https://wiki.tcl-lang.org/page/photo" class="sh_keyword">photo</a> stop <span class="sh_symbol">-</span><a href="https://wiki.tcl-lang.org/page/file" class="sh_keyword">file</a> <span class="sh_variable">$thisdir</span><span class="sh_symbol">/</span>stop<span class="sh_number">.</span>gif

<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal <span class="sh_cbracket">{{</span>w <span class="sh_string">""</span><span class="sh_cbracket">}}</span> <span class="sh_cbracket">{</span>
    wm title <span class="sh_symbol">.</span> <span class="sh_string">"Visual TAL"</span>
    <a href="https://wiki.tcl-lang.org/page/global" class="sh_keyword">global</a> g
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>stack<span class="sh_symbol">)</span> <span class="sh_symbol">---</span>bottom<span class="sh_symbol">---</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>bp<span class="sh_symbol">)</span> <span class="sh_number">0</span>
    <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_cbracket">{</span><span class="sh_variable">$w</span> ne <span class="sh_string">""</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/pack" class="sh_keyword">pack</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/frame" class="sh_keyword">frame</a> <span class="sh_variable">$w</span><span class="sh_symbol">]</span> <span class="sh_symbol">-</span>fill both <span class="sh_symbol">-</span>expand <span class="sh_number">1</span><span class="sh_cbracket">}</span>
    <a href="https://wiki.tcl-lang.org/page/pack" class="sh_keyword">pack</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/frame" class="sh_keyword">frame</a> <span class="sh_variable">$w</span><span class="sh_number">.</span>top<span class="sh_symbol">]</span> <span class="sh_symbol">-</span>side top
    <a href="https://wiki.tcl-lang.org/page/button" class="sh_keyword">button</a> <span class="sh_variable">$w</span><span class="sh_number">.</span>top<span class="sh_number">.1</span> <span class="sh_symbol">-</span><a href="https://wiki.tcl-lang.org/page/text" class="sh_keyword">text</a> <span class="sh_string">"Step"</span> <span class="sh_symbol">-</span>command vtal<span class="sh_number">.</span>step
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>run<span class="sh_symbol">)</span> <span class="sh_variable">$w</span><span class="sh_number">.</span>top<span class="sh_number">.2</span>
    <a href="https://wiki.tcl-lang.org/page/button" class="sh_keyword">button</a> <span class="sh_variable">$w</span><span class="sh_number">.</span>top<span class="sh_number">.2</span> <span class="sh_symbol">-</span><a href="https://wiki.tcl-lang.org/page/text" class="sh_keyword">text</a> Run <span class="sh_symbol">-</span>command vtal<span class="sh_number">.</span>run
    <a href="https://wiki.tcl-lang.org/page/button" class="sh_keyword">button</a> <span class="sh_variable">$w</span><span class="sh_number">.</span>top<span class="sh_number">.</span>2a <span class="sh_symbol">-</span><a href="https://wiki.tcl-lang.org/page/text" class="sh_keyword">text</a> Reset <span class="sh_symbol">-</span>command vtal<span class="sh_number">.</span>reset
    <a href="https://wiki.tcl-lang.org/page/label" class="sh_keyword">label</a> <span class="sh_variable">$w</span><span class="sh_number">.</span>top<span class="sh_number">.3</span> <span class="sh_symbol">-</span><a href="https://wiki.tcl-lang.org/page/text" class="sh_keyword">text</a> <span class="sh_string">"proc f "</span> <span class="sh_symbol">-</span>background white
    <a href="https://wiki.tcl-lang.org/page/entry" class="sh_keyword">entry</a> <span class="sh_variable">$w</span><span class="sh_number">.</span>top<span class="sh_number">.4</span> <span class="sh_symbol">-</span>width <span class="sh_number">80</span> <span class="sh_symbol">-</span>textvar g<span class="sh_symbol">(</span><a href="https://wiki.tcl-lang.org/page/entry" class="sh_keyword">entry</a><span class="sh_symbol">)</span>
    <a href="https://wiki.tcl-lang.org/page/bind" class="sh_keyword">bind</a>  <span class="sh_variable">$w</span><span class="sh_number">.</span>top<span class="sh_number">.4</span> <span class="sh_symbol">&lt;</span>Return<span class="sh_symbol">&gt;</span> vtal<span class="sh_number">.</span>refresh
    <a href="https://wiki.tcl-lang.org/page/eval" class="sh_keyword">eval</a> <a href="https://wiki.tcl-lang.org/page/pack" class="sh_keyword">pack</a> <span class="sh_symbol">[</span>winfo children <span class="sh_variable">$w</span><span class="sh_number">.</span>top<span class="sh_symbol">]</span> <span class="sh_symbol">-</span>side left <span class="sh_symbol">-</span>fill y
    <a href="https://wiki.tcl-lang.org/page/pack" class="sh_keyword">pack</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/label" class="sh_keyword">label</a> <span class="sh_variable">$w</span><span class="sh_number">.</span><a href="https://wiki.tcl-lang.org/page/info" class="sh_keyword">info</a> <span class="sh_symbol">-</span>textvariable g<span class="sh_symbol">(</span>Info<span class="sh_symbol">)]</span> <span class="sh_symbol">-</span>side bottom
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>Info<span class="sh_symbol">)</span> <span class="sh_string">"Welcome to Visual TAL"</span>
    <a href="https://wiki.tcl-lang.org/page/pack" class="sh_keyword">pack</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/frame" class="sh_keyword">frame</a> <span class="sh_variable">$w</span><span class="sh_number">.</span>right<span class="sh_symbol">]</span> <span class="sh_symbol">-</span>side right <span class="sh_symbol">-</span>fill both <span class="sh_symbol">-</span>expand <span class="sh_number">1</span>
    <a href="https://wiki.tcl-lang.org/page/pack" class="sh_keyword">pack</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/label" class="sh_keyword">label</a> <span class="sh_variable">$w</span><span class="sh_number">.</span>right<span class="sh_number">.1</span> <span class="sh_symbol">-</span><a href="https://wiki.tcl-lang.org/page/text" class="sh_keyword">text</a> <span class="sh_string">"Local variables"</span> <span class="sh_symbol">-</span>relief raised<span class="sh_symbol">]</span> <span class="sh_symbol">-</span>fill x
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>vars<span class="sh_symbol">)</span> <span class="sh_variable">$w</span><span class="sh_number">.</span>right<span class="sh_number">.</span>vars
    <a href="https://wiki.tcl-lang.org/page/pack" class="sh_keyword">pack</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/frame" class="sh_keyword">frame</a> <span class="sh_variable">$g</span><span class="sh_symbol">(</span>vars<span class="sh_symbol">)]</span> <span class="sh_symbol">-</span>fill x
    <a href="https://wiki.tcl-lang.org/page/pack" class="sh_keyword">pack</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/label" class="sh_keyword">label</a> <span class="sh_variable">$w</span><span class="sh_number">.</span>right<span class="sh_number">.2</span> <span class="sh_symbol">-</span><a href="https://wiki.tcl-lang.org/page/text" class="sh_keyword">text</a> Stack <span class="sh_symbol">-</span>relief raised<span class="sh_symbol">]</span> <span class="sh_symbol">-</span>fill x
    <a href="https://wiki.tcl-lang.org/page/pack" class="sh_keyword">pack</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/text" class="sh_keyword">text</a> <span class="sh_variable">$w</span><span class="sh_number">.</span>right<span class="sh_number">.</span>stack <span class="sh_symbol">-</span>width <span class="sh_number">32</span><span class="sh_symbol">]</span> <span class="sh_symbol">-</span>fill both <span class="sh_symbol">-</span>expand <span class="sh_number">1</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>stk<span class="sh_symbol">)</span> <span class="sh_variable">$w</span><span class="sh_number">.</span>right<span class="sh_number">.</span>stack
    <a href="https://wiki.tcl-lang.org/page/pack" class="sh_keyword">pack</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/scrollbar" class="sh_keyword">scrollbar</a> <span class="sh_variable">$w</span><span class="sh_number">.</span>y <span class="sh_symbol">-</span>command <span class="sh_string">"$w.t yview"</span><span class="sh_symbol">]</span> <span class="sh_symbol">-</span>side right <span class="sh_symbol">-</span>fill y
    <a href="https://wiki.tcl-lang.org/page/pack" class="sh_keyword">pack</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/text" class="sh_keyword">text</a> <span class="sh_variable">$w</span><span class="sh_number">.</span>t <span class="sh_symbol">-</span>wrap word <span class="sh_symbol">\</span>
              <span class="sh_symbol">-</span>width <span class="sh_number">72</span> <span class="sh_symbol">-</span>yscrollcommand <span class="sh_string">"$w.y set"</span><span class="sh_symbol">]</span> <span class="sh_symbol">-</span>fill both <span class="sh_symbol">-</span>expand <span class="sh_number">1</span>
    <span class="sh_variable">$w</span><span class="sh_number">.</span>t tag configure hilite <span class="sh_symbol">-</span>background yellow
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>txt<span class="sh_symbol">)</span> <span class="sh_variable">$w</span><span class="sh_number">.</span>t
    <a href="https://wiki.tcl-lang.org/page/bind" class="sh_keyword">bind</a> <span class="sh_variable">$w</span><span class="sh_number">.</span>t <span class="sh_symbol">&lt;</span><span class="sh_number">3</span><span class="sh_symbol">&gt;</span> <span class="sh_cbracket">{</span>breakpoint <span class="sh_symbol">%</span>W <span class="sh_symbol">%</span>x <span class="sh_symbol">%</span>y<span class="sh_cbracket">}</span>
    <a href="https://wiki.tcl-lang.org/page/foreach" class="sh_keyword">foreach</a> i <span class="sh_cbracket">{</span>red blue<span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span><span class="sh_variable">$w</span><span class="sh_number">.</span>t tag configure <span class="sh_variable">$i</span> <span class="sh_symbol">-</span>foreground <span class="sh_variable">$i</span><span class="sh_cbracket">}</span>
    <a href="https://wiki.tcl-lang.org/page/bind" class="sh_keyword">bind</a> all <span class="sh_symbol">&lt;</span>Down<span class="sh_symbol">&gt;</span> vtal<span class="sh_number">.</span>step
    vtal<span class="sh_number">.</span>showstack
    <a href="https://wiki.tcl-lang.org/page/bind" class="sh_keyword">bind</a> all <span class="sh_symbol">&lt;</span>F9<span class="sh_symbol">&gt;</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/console" class="sh_keyword">console</a> show<span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> breakpoint <span class="sh_cbracket">{</span>w x y<span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> pos <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> int<span class="sh_symbol">([</span><span class="sh_variable">$w</span> index @<span class="sh_variable">$x</span><span class="sh_symbol">,</span><span class="sh_variable">$y</span><span class="sh_symbol">])]</span>
    <span class="sh_variable">$w</span> <a href="https://wiki.tcl-lang.org/page/image" class="sh_keyword">image</a> create <span class="sh_variable">$pos</span><span class="sh_number">.0</span> <span class="sh_symbol">-</span><a href="https://wiki.tcl-lang.org/page/image" class="sh_keyword">image</a> stop
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span>reset <span class="sh_cbracket">{}</span> <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/global" class="sh_keyword">global</a> g slot
    vtal<span class="sh_number">.</span>hilite <span class="sh_variable">$g</span><span class="sh_symbol">(</span>txt<span class="sh_symbol">)</span> <span class="sh_number">2</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>stack<span class="sh_symbol">)</span> <span class="sh_symbol">---</span>bottom<span class="sh_symbol">---</span>
    vtal<span class="sh_number">.</span>showstack
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>Info<span class="sh_symbol">)</span> Ready<span class="sh_symbol">.</span>
    <a href="https://wiki.tcl-lang.org/page/foreach" class="sh_keyword">foreach</a> <span class="sh_cbracket">{</span>num descr<span class="sh_cbracket">}</span> <span class="sh_symbol">[</span>array get slot<span class="sh_symbol">]</span> <span class="sh_cbracket">{</span>
        <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_symbol">![</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> match <span class="sh_symbol">*</span>arg<span class="sh_symbol">,*</span> <span class="sh_variable">$descr</span><span class="sh_symbol">]</span> <span class="sh_cbracket">{</span>
            <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> match <span class="sh_symbol">*</span>temp<span class="sh_symbol">*</span> <span class="sh_variable">$descr</span><span class="sh_symbol">]</span> <span class="sh_cbracket">{</span>
                <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> name <span class="sh_variable">$num</span>
            <span class="sh_cbracket">}</span> <a href="https://wiki.tcl-lang.org/page/else" class="sh_keyword">else</a> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> name <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/lindex" class="sh_keyword">lindex</a> <span class="sh_variable">$descr</span> end<span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>var<span class="sh_symbol">,</span><span class="sh_variable">$name</span><span class="sh_symbol">)</span> <span class="sh_string">""</span>
        <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span>refresh <span class="sh_cbracket">{{</span>function <span class="sh_string">""</span><span class="sh_cbracket">}}</span> <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/global" class="sh_keyword">global</a> g slot
    <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_cbracket">{</span><span class="sh_variable">$function</span> ne <span class="sh_string">""</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span><a href="https://wiki.tcl-lang.org/page/entry" class="sh_keyword">entry</a><span class="sh_symbol">)</span> <span class="sh_variable">$function</span><span class="sh_cbracket">}</span>
    array unset g var<span class="sh_symbol">,*</span>
    vtal<span class="sh_number">.</span>reset
    <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/catch" class="sh_keyword">catch</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/list" class="sh_keyword">list</a> <a href="https://wiki.tcl-lang.org/page/eval" class="sh_keyword">eval</a> <span class="sh_symbol">[</span>linsert <span class="sh_variable">$g</span><span class="sh_symbol">(</span><a href="https://wiki.tcl-lang.org/page/entry" class="sh_keyword">entry</a><span class="sh_symbol">)</span> <span class="sh_number">0</span> <a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> f<span class="sh_symbol">]]</span> msg<span class="sh_symbol">]</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/error" class="sh_keyword">error</a> <span class="sh_variable">$msg</span><span class="sh_cbracket">}</span>
    <a href="https://wiki.tcl-lang.org/page/foreach" class="sh_keyword">foreach</a> <span class="sh_cbracket">{</span>argl<span class="sh_cbracket">}</span> <span class="sh_variable">$g</span><span class="sh_symbol">(</span><a href="https://wiki.tcl-lang.org/page/entry" class="sh_keyword">entry</a><span class="sh_symbol">)</span> <a href="https://wiki.tcl-lang.org/page/break" class="sh_keyword">break</a>
    array unset slot
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> asm <span class="sh_symbol">[</span>dis2asm <span class="sh_symbol">[</span>disasm <a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> f<span class="sh_symbol">]]</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> res <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/list" class="sh_keyword">list</a> <a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> f <span class="sh_variable">$argl</span> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/list" class="sh_keyword">list</a> asm <span class="sh_variable">$asm</span><span class="sh_symbol">]]</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> rc <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/catch" class="sh_keyword">catch</a> <span class="sh_variable">$res</span> msg<span class="sh_symbol">]</span>
    vtal<span class="sh_number">.</span>show <span class="sh_variable">$g</span><span class="sh_symbol">(</span>txt<span class="sh_symbol">)</span> <span class="sh_variable">$res</span>
    <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_cbracket">{</span><span class="sh_variable">$rc</span> <span class="sh_symbol">!=</span> <span class="sh_number">0</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/error" class="sh_keyword">error</a> <span class="sh_variable">$msg</span><span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span>run <span class="sh_cbracket">{}</span> <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/global" class="sh_keyword">global</a> g
    <span class="sh_variable">$g</span><span class="sh_symbol">(</span>run<span class="sh_symbol">)</span> configure <span class="sh_symbol">-</span><a href="https://wiki.tcl-lang.org/page/text" class="sh_keyword">text</a> Stop <span class="sh_symbol">-</span>command vtal<span class="sh_number">.</span>stop
    every <span class="sh_variable">$g</span><span class="sh_symbol">(</span>delay<span class="sh_symbol">)</span> vtal<span class="sh_number">.</span>step
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>delay<span class="sh_symbol">)</span> <span class="sh_number">200</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> every <span class="sh_cbracket">{</span>ms body<span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/uplevel" class="sh_keyword">uplevel</a> #<span class="sh_number">0</span> <span class="sh_variable">$body</span><span class="sh_symbol">;</span> after <span class="sh_variable">$ms</span> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/namespace" class="sh_keyword">namespace</a> code <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/info" class="sh_keyword">info</a> level <span class="sh_number">0</span><span class="sh_symbol">]]</span><span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span>stop <span class="sh_cbracket">{}</span> <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/global" class="sh_keyword">global</a> g
    <a href="https://wiki.tcl-lang.org/page/foreach" class="sh_keyword">foreach</a> id <span class="sh_symbol">[</span>after <a href="https://wiki.tcl-lang.org/page/info" class="sh_keyword">info</a><span class="sh_symbol">]</span> <span class="sh_cbracket">{</span>after cancel <span class="sh_variable">$id</span><span class="sh_cbracket">}</span>
    <span class="sh_variable">$g</span><span class="sh_symbol">(</span>run<span class="sh_symbol">)</span> configure <span class="sh_symbol">-</span><a href="https://wiki.tcl-lang.org/page/text" class="sh_keyword">text</a> Run <span class="sh_symbol">-</span>command vtal<span class="sh_number">.</span>run
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span>show <span class="sh_cbracket">{</span>w str<span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span>
    <span class="sh_variable">$w</span> delete <span class="sh_number">1.0</span> end
    <a href="https://wiki.tcl-lang.org/page/foreach" class="sh_keyword">foreach</a> line <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/split" class="sh_keyword">split</a> <span class="sh_variable">$str</span> <span class="sh_symbol">\</span>n<span class="sh_symbol">]</span> <span class="sh_cbracket">{</span>
        <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/regexp" class="sh_keyword">regexp</a> <span class="sh_cbracket">{</span><span class="sh_symbol">^(</span><a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a><span class="sh_symbol">|\</span><span class="sh_cbracket">}</span><span class="sh_symbol">)</span><span class="sh_cbracket">}</span> <span class="sh_variable">$line</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span>
            <span class="sh_variable">$w</span> insert end <span class="sh_variable">$line</span><span class="sh_symbol">\</span>n blue
        <span class="sh_cbracket">}</span> <a href="https://wiki.tcl-lang.org/page/else" class="sh_keyword">else</a> <span class="sh_cbracket">{</span>
            <a href="https://wiki.tcl-lang.org/page/foreach" class="sh_keyword">foreach</a> <span class="sh_cbracket">{</span>code cmt rest<span class="sh_cbracket">}</span> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/split" class="sh_keyword">split</a> <span class="sh_variable">$line</span> #<span class="sh_symbol">]</span> <a href="https://wiki.tcl-lang.org/page/break" class="sh_keyword">break</a>
            <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> code <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> trimright <span class="sh_variable">$code</span> <span class="sh_string">";"</span><span class="sh_symbol">]</span>
            <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_cbracket">{</span><span class="sh_variable">$cmt</span> ne <span class="sh_string">""</span><span class="sh_cbracket">}</span>  <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> cmt <span class="sh_string">";#$cmt"</span><span class="sh_cbracket">}</span>
            <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_cbracket">{</span><span class="sh_variable">$rest</span> ne <span class="sh_string">""</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> rest #<span class="sh_variable">$rest</span><span class="sh_cbracket">}</span>
            <span class="sh_variable">$w</span> insert end <span class="sh_variable">$code</span> <span class="sh_string">""</span> <span class="sh_variable">$cmt</span> red <span class="sh_variable">$rest</span><span class="sh_symbol">\</span>n red 
        <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_variable">$w</span> tag add hilite <span class="sh_number">2.0</span> <span class="sh_number">2.</span>end
    vtal<span class="sh_number">.</span>vars
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span>vars <span class="sh_cbracket">{}</span> <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/global" class="sh_keyword">global</a> g slot
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> w <span class="sh_variable">$g</span><span class="sh_symbol">(</span>vars<span class="sh_symbol">)</span>
    <a href="https://wiki.tcl-lang.org/page/eval" class="sh_keyword">eval</a> <a href="https://wiki.tcl-lang.org/page/destroy" class="sh_keyword">destroy</a> <span class="sh_symbol">[</span>winfo children <span class="sh_variable">$w</span><span class="sh_symbol">]</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> i <span class="sh_number">0</span>
    <a href="https://wiki.tcl-lang.org/page/foreach" class="sh_keyword">foreach</a> num <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/lsort" class="sh_keyword">lsort</a> <span class="sh_symbol">-</span><a href="https://wiki.tcl-lang.org/page/dict" class="sh_keyword">dict</a> <span class="sh_symbol">[</span>array names slot<span class="sh_symbol">]]</span> <span class="sh_cbracket">{</span>
        <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> lvar <span class="sh_variable">$slot</span><span class="sh_symbol">(</span><span class="sh_variable">$num</span><span class="sh_symbol">)</span>
        <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> varname <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/lindex" class="sh_keyword">lindex</a> <span class="sh_variable">$lvar</span> end<span class="sh_symbol">]</span>
        <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_cbracket">{</span><span class="sh_variable">$varname</span> eq <span class="sh_string">"temp"</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> varname <span class="sh_variable">$num</span><span class="sh_cbracket">}</span>
        <a href="https://wiki.tcl-lang.org/page/grid" class="sh_keyword">grid</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/label" class="sh_keyword">label</a> <span class="sh_variable">$w</span><span class="sh_symbol">.[</span><a href="https://wiki.tcl-lang.org/page/incr" class="sh_keyword">incr</a> i<span class="sh_symbol">]</span> <span class="sh_symbol">-</span><a href="https://wiki.tcl-lang.org/page/text" class="sh_keyword">text</a> <span class="sh_string">"%v$num: $lvar"</span><span class="sh_symbol">]</span> <span class="sh_symbol">\</span>
            <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/entry" class="sh_keyword">entry</a> <span class="sh_variable">$w</span><span class="sh_symbol">.[</span><a href="https://wiki.tcl-lang.org/page/incr" class="sh_keyword">incr</a> i<span class="sh_symbol">]</span> <span class="sh_symbol">-</span>textvariable g<span class="sh_symbol">(</span>var<span class="sh_symbol">,</span><span class="sh_variable">$varname</span><span class="sh_symbol">)]</span> <span class="sh_symbol">-</span>sticky w
    <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span>step <span class="sh_cbracket">{}</span> <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/global" class="sh_keyword">global</a> g
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> w <span class="sh_variable">$g</span><span class="sh_symbol">(</span>txt<span class="sh_symbol">)</span>
    <a href="https://wiki.tcl-lang.org/page/foreach" class="sh_keyword">foreach</a> <span class="sh_cbracket">{</span>from to<span class="sh_cbracket">}</span> <span class="sh_symbol">[</span><span class="sh_variable">$w</span> tag ranges hilite<span class="sh_symbol">]</span> <a href="https://wiki.tcl-lang.org/page/break" class="sh_keyword">break</a>
    <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_symbol">![</span><a href="https://wiki.tcl-lang.org/page/info" class="sh_keyword">info</a> exists from<span class="sh_symbol">]</span> <a href="https://wiki.tcl-lang.org/page/return" class="sh_keyword">return</a>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> lineno <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/lindex" class="sh_keyword">lindex</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/split" class="sh_keyword">split</a> <span class="sh_variable">$from</span> <span class="sh_symbol">.]</span> <span class="sh_number">0</span><span class="sh_symbol">]</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> cmd <span class="sh_symbol">[</span><span class="sh_variable">$w</span> get <span class="sh_variable">$from</span> <span class="sh_variable">$to</span><span class="sh_symbol">]</span>
    <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> match <span class="sh_symbol">\</span><span class="sh_cbracket">}</span><span class="sh_symbol">*</span> <span class="sh_variable">$cmd</span><span class="sh_symbol">]</span> <span class="sh_symbol">||</span> <span class="sh_variable">$g</span><span class="sh_symbol">(</span>bp<span class="sh_symbol">)==</span><span class="sh_number">0</span> <span class="sh_symbol">&amp;&amp;</span> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/scan" class="sh_keyword">scan</a> <span class="sh_symbol">[</span><span class="sh_variable">$w</span> get <span class="sh_variable">$lineno</span><span class="sh_number">.0</span><span class="sh_symbol">]</span> <span class="sh_symbol">%</span>c<span class="sh_symbol">]</span> eq <span class="sh_string">""</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span>
        <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>bp<span class="sh_symbol">)</span> <span class="sh_number">1</span>
        after <span class="sh_number">1</span> vtal<span class="sh_number">.</span>stop
        <a href="https://wiki.tcl-lang.org/page/return" class="sh_keyword">return</a>
    <span class="sh_cbracket">}</span>
    <a href="https://wiki.tcl-lang.org/page/incr" class="sh_keyword">incr</a> lineno
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>Info<span class="sh_symbol">)</span> <span class="sh_variable">$cmd</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> lineno <span class="sh_symbol">[</span>vtal<span class="sh_number">.</span><a href="https://wiki.tcl-lang.org/page/eval" class="sh_keyword">eval</a> <span class="sh_variable">$cmd</span> <span class="sh_variable">$lineno</span><span class="sh_symbol">]</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>bp<span class="sh_symbol">)</span> <span class="sh_number">0</span>
    vtal<span class="sh_number">.</span>hilite <span class="sh_variable">$w</span> <span class="sh_variable">$lineno</span>
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span><a href="https://wiki.tcl-lang.org/page/eval" class="sh_keyword">eval</a> <span class="sh_cbracket">{</span>cmd line<span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/global" class="sh_keyword">global</a> g
    <a href="https://wiki.tcl-lang.org/page/foreach" class="sh_keyword">foreach</a> part <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/split" class="sh_keyword">split</a> <span class="sh_variable">$cmd</span> <span class="sh_string">";"</span><span class="sh_symbol">]</span> <span class="sh_cbracket">{</span>
        <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> match #<span class="sh_symbol">*</span> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> trim <span class="sh_variable">$part</span><span class="sh_symbol">]]</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/return" class="sh_keyword">return</a> <span class="sh_variable">$line</span><span class="sh_cbracket">}</span>
        <a href="https://wiki.tcl-lang.org/page/foreach" class="sh_keyword">foreach</a> <span class="sh_cbracket">{</span>instr arg1 arg2<span class="sh_cbracket">}</span> <span class="sh_variable">$part</span> <a href="https://wiki.tcl-lang.org/page/break" class="sh_keyword">break</a>
        <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_symbol">![</span><a href="https://wiki.tcl-lang.org/page/info" class="sh_keyword">info</a> exists instr<span class="sh_symbol">]</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/return" class="sh_keyword">return</a> <span class="sh_variable">$line</span><span class="sh_cbracket">}</span>
        <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> tos <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/lindex" class="sh_keyword">lindex</a> <span class="sh_variable">$g</span><span class="sh_symbol">(</span>stack<span class="sh_symbol">)</span> <span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_comment">;# top of stack</span>
        <a href="https://wiki.tcl-lang.org/page/switch" class="sh_keyword">switch</a> <span class="sh_variable">$instr</span> <span class="sh_cbracket">{</span>
            add              <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">+</span> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            <a href="https://wiki.tcl-lang.org/page/append" class="sh_keyword">append</a>           <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/append" class="sh_keyword">append</a> g<span class="sh_symbol">(</span>var<span class="sh_symbol">,</span><span class="sh_variable">$arg1</span><span class="sh_symbol">)</span> <span class="sh_variable">$tos</span><span class="sh_cbracket">}</span>
            bitand           <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">&amp;</span> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            bitnot           <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">~</span> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            bitor            <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">|</span> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            bitxor           <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">^</span> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            <a href="https://wiki.tcl-lang.org/page/concat" class="sh_keyword">concat</a>           <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span>vtal<span class="sh_number">.</span><a href="https://wiki.tcl-lang.org/page/concat" class="sh_keyword">concat</a> <span class="sh_variable">$arg1</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            currentNamespace <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/namespace" class="sh_keyword">namespace</a> current<span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            div              <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">/</span> <span class="sh_variable">$x</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            dup              <span class="sh_cbracket">{</span>push <span class="sh_variable">$tos</span><span class="sh_cbracket">}</span>
            eq               <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">==</span> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            existArrayStk    <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/info" class="sh_keyword">info</a> exists <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> x<span class="sh_symbol">]([</span>pop<span class="sh_symbol">])]</span><span class="sh_cbracket">}</span>
            exist            <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/info" class="sh_keyword">info</a> exists <span class="sh_variable">$arg1</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            expon            <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]**</span><span class="sh_variable">$x</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            ge               <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">&gt;=</span> <span class="sh_variable">$x</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            gt               <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">&gt;</span> <span class="sh_variable">$x</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            <a href="https://wiki.tcl-lang.org/page/incr" class="sh_keyword">incr</a>             <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">+</span> <span class="sh_variable">$arg1</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            incrImm <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span>vtal<span class="sh_number">.</span>store <span class="sh_variable">$arg1</span> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>vtal<span class="sh_number">.</span><a href="https://wiki.tcl-lang.org/page/load" class="sh_keyword">load</a> <span class="sh_variable">$arg1</span><span class="sh_symbol">]</span> <span class="sh_symbol">+</span> <span class="sh_variable">$arg2</span><span class="sh_cbracket">}</span><span class="sh_symbol">]]</span><span class="sh_cbracket">}</span>
            invokeStk  <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span>vtal<span class="sh_number">.</span>invoke <span class="sh_variable">$arg1</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            jump       <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> line <span class="sh_symbol">[</span>vtal<span class="sh_number">.</span>jump <span class="sh_variable">$arg1</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            jumpTrue   <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">!=</span> <span class="sh_number">0</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> line <span class="sh_symbol">[</span>vtal<span class="sh_number">.</span>jump <span class="sh_variable">$arg1</span><span class="sh_symbol">]</span><span class="sh_cbracket">}}</span>
            jumpFalse  <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">==</span> <span class="sh_number">0</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> line <span class="sh_symbol">[</span>vtal<span class="sh_number">.</span>jump <span class="sh_variable">$arg1</span><span class="sh_symbol">]</span><span class="sh_cbracket">}}</span>
            <a href="https://wiki.tcl-lang.org/page/label" class="sh_keyword">label</a>      <span class="sh_cbracket">{}</span>
            <a href="https://wiki.tcl-lang.org/page/lappend" class="sh_keyword">lappend</a>    <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/lappend" class="sh_keyword">lappend</a> g<span class="sh_symbol">(</span>var<span class="sh_symbol">,</span><span class="sh_variable">$arg1</span><span class="sh_symbol">)</span> <span class="sh_variable">$tos</span><span class="sh_cbracket">}</span>
            land       <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">&amp;&amp;</span> <span class="sh_variable">$x</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            <a href="https://wiki.tcl-lang.org/page/list" class="sh_keyword">list</a>       <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span>vtal<span class="sh_number">.</span><a href="https://wiki.tcl-lang.org/page/list" class="sh_keyword">list</a> <span class="sh_variable">$arg1</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            listIn     <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> in <span class="sh_variable">$x</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            listIndex  <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/lindex" class="sh_keyword">lindex</a> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_variable">$x</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            listLength <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/llength" class="sh_keyword">llength</a> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]]</span><span class="sh_cbracket">}</span>
            listNotIn  <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> ni <span class="sh_variable">$x</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            <a href="https://wiki.tcl-lang.org/page/load" class="sh_keyword">load</a>       <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span>vtal<span class="sh_number">.</span><a href="https://wiki.tcl-lang.org/page/load" class="sh_keyword">load</a> <span class="sh_variable">$arg1</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            lor        <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">||</span> <span class="sh_variable">$x</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            lshift     <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">&lt;&lt;</span> <span class="sh_variable">$x</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            le         <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">&lt;=</span> <span class="sh_variable">$x</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            lt         <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">&lt;</span> <span class="sh_variable">$x</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            mod        <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">%</span> <span class="sh_variable">$x</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            mult       <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">*</span> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            neq        <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">!=</span> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            nop        <span class="sh_cbracket">{}</span>
            not        <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">!</span> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            pop         pop
            push       <span class="sh_cbracket">{</span>push <span class="sh_variable">$arg1</span><span class="sh_cbracket">}</span>
            rshift     <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">&gt;&gt;</span> <span class="sh_variable">$x</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            store      <span class="sh_cbracket">{</span>vtal<span class="sh_number">.</span>store <span class="sh_variable">$arg1</span> <span class="sh_variable">$tos</span><span class="sh_cbracket">}</span>
            strcmp     <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> compare <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_variable">$x</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            streq      <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> equal <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]]</span><span class="sh_cbracket">}</span>
            strfind    <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> first <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_variable">$x</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            strindex   <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> index <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_variable">$x</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            strlen     <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> length <span class="sh_symbol">[</span>pop<span class="sh_symbol">]]</span><span class="sh_cbracket">}</span>
            strmap     <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> map <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_variable">$x</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            strmatch   <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> match <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_variable">$x</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            strneq     <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_symbol">![</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> equal <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]]]</span><span class="sh_cbracket">}</span>
            strrange   <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> range <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_variable">$arg1</span> <span class="sh_variable">$arg2</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            strrfind   <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/string" class="sh_keyword">string</a> last <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_variable">$x</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            sub        <span class="sh_cbracket">{</span>pop x<span class="sh_symbol">;</span> push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span> <span class="sh_symbol">-</span> <span class="sh_variable">$x</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            tryCvtToNumeric <span class="sh_cbracket">{}</span>
            uminus     <span class="sh_cbracket">{</span>push <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/expr" class="sh_keyword">expr</a> <span class="sh_cbracket">{</span><span class="sh_symbol">-[</span>pop<span class="sh_symbol">]</span><span class="sh_cbracket">}</span><span class="sh_symbol">]</span><span class="sh_cbracket">}</span>
            unset      <span class="sh_cbracket">{</span>unset <span class="sh_variable">$arg1</span><span class="sh_cbracket">}</span>
            <span class="sh_string">""</span>         <span class="sh_cbracket">{}</span>
            <a href="https://wiki.tcl-lang.org/page/default" class="sh_keyword">default</a>   <span class="sh_cbracket">{</span>vtal<span class="sh_number">.</span>stop<span class="sh_symbol">;</span> <a href="https://wiki.tcl-lang.org/page/error" class="sh_keyword">error</a> <span class="sh_string">"instruction $part not yet implemented"</span><span class="sh_cbracket">}</span>
        <span class="sh_cbracket">}</span>
    <span class="sh_cbracket">}</span>
    <a href="https://wiki.tcl-lang.org/page/return" class="sh_keyword">return</a> <span class="sh_variable">$line</span>
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span><a href="https://wiki.tcl-lang.org/page/concat" class="sh_keyword">concat</a> num <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> res <span class="sh_cbracket">{}</span>
    <a href="https://wiki.tcl-lang.org/page/while" class="sh_keyword">while</a> <span class="sh_cbracket">{</span><span class="sh_variable">$num</span> <span class="sh_symbol">&gt;</span> <span class="sh_number">0</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span>
        <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> res <span class="sh_symbol">[</span>pop<span class="sh_symbol">]</span><span class="sh_variable">$res</span>
        <a href="https://wiki.tcl-lang.org/page/incr" class="sh_keyword">incr</a> num <span class="sh_symbol">-</span><span class="sh_number">1</span>
    <span class="sh_cbracket">}</span>
    <a href="https://wiki.tcl-lang.org/page/return" class="sh_keyword">return</a> <span class="sh_variable">$res</span>
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span><a href="https://wiki.tcl-lang.org/page/list" class="sh_keyword">list</a> num <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> res <span class="sh_cbracket">{}</span>
    <a href="https://wiki.tcl-lang.org/page/while" class="sh_keyword">while</a> <span class="sh_cbracket">{</span><span class="sh_variable">$num</span> <span class="sh_symbol">&gt;</span> <span class="sh_number">0</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span>
        <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> res <span class="sh_symbol">[</span>linsert <span class="sh_variable">$res</span> <span class="sh_number">0</span> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]]</span>
        <a href="https://wiki.tcl-lang.org/page/incr" class="sh_keyword">incr</a> num <span class="sh_symbol">-</span><span class="sh_number">1</span>
    <span class="sh_cbracket">}</span>
    <a href="https://wiki.tcl-lang.org/page/return" class="sh_keyword">return</a> <span class="sh_variable">$res</span>
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span>invoke num <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> cmd <span class="sh_cbracket">{}</span>
    <a href="https://wiki.tcl-lang.org/page/while" class="sh_keyword">while</a> <span class="sh_cbracket">{</span><span class="sh_variable">$num</span> <span class="sh_symbol">&gt;</span> <span class="sh_number">0</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span>
        <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> cmd <span class="sh_symbol">[</span>linsert <span class="sh_variable">$cmd</span> <span class="sh_number">0</span> <span class="sh_symbol">[</span>pop<span class="sh_symbol">]]</span>
        <a href="https://wiki.tcl-lang.org/page/incr" class="sh_keyword">incr</a> num <span class="sh_symbol">-</span><span class="sh_number">1</span>
    <span class="sh_cbracket">}</span>
    <a href="https://wiki.tcl-lang.org/page/catch" class="sh_keyword">catch</a> <span class="sh_variable">$cmd</span> res
    <a href="https://wiki.tcl-lang.org/page/return" class="sh_keyword">return</a> <span class="sh_variable">$res</span>
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span>jump <a href="https://wiki.tcl-lang.org/page/label" class="sh_keyword">label</a> <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/global" class="sh_keyword">global</a> g
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> pos <span class="sh_symbol">[</span><span class="sh_variable">$g</span><span class="sh_symbol">(</span>txt<span class="sh_symbol">)</span> search <span class="sh_string">"label $label"</span> <span class="sh_number">1.0</span><span class="sh_symbol">]</span>
    <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_cbracket">{</span><span class="sh_variable">$pos</span> eq <span class="sh_string">""</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/error" class="sh_keyword">error</a> <span class="sh_string">"label $label not found"</span><span class="sh_cbracket">}</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> line <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/lindex" class="sh_keyword">lindex</a> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/split" class="sh_keyword">split</a> <span class="sh_variable">$pos</span> <span class="sh_symbol">.]</span> <span class="sh_number">0</span><span class="sh_symbol">]</span>
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span><a href="https://wiki.tcl-lang.org/page/load" class="sh_keyword">load</a>   name        <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/return" class="sh_keyword">return</a> <span class="sh_variable">$::g</span><span class="sh_symbol">(</span>var<span class="sh_symbol">,</span><span class="sh_variable">$name</span><span class="sh_symbol">)</span><span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span>store <span class="sh_cbracket">{</span>name value<span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_symbol">![</span><a href="https://wiki.tcl-lang.org/page/info" class="sh_keyword">info</a> exists <span class="sh_symbol">::</span>g<span class="sh_symbol">(</span>var<span class="sh_symbol">,</span><span class="sh_variable">$name</span><span class="sh_symbol">)]</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/error" class="sh_keyword">error</a> <span class="sh_string">"no local variable $name"</span><span class="sh_cbracket">}</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> <span class="sh_symbol">::</span>g<span class="sh_symbol">(</span>var<span class="sh_symbol">,</span><span class="sh_variable">$name</span><span class="sh_symbol">)</span> <span class="sh_variable">$value</span>
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> pop <span class="sh_cbracket">{{</span>_v <span class="sh_string">""</span><span class="sh_cbracket">}}</span> <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/global" class="sh_keyword">global</a> g
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> res <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/lindex" class="sh_keyword">lindex</a> <span class="sh_variable">$g</span><span class="sh_symbol">(</span>stack<span class="sh_symbol">)</span> <span class="sh_number">0</span><span class="sh_symbol">]</span>
    <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_cbracket">{</span><span class="sh_variable">$res</span> eq <span class="sh_string">"---bottom---"</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/error" class="sh_keyword">error</a> <span class="sh_string">"stack underflow"</span><span class="sh_cbracket">}</span>
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>stack<span class="sh_symbol">)</span> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/lrange" class="sh_keyword">lrange</a> <span class="sh_variable">$g</span><span class="sh_symbol">(</span>stack<span class="sh_symbol">)</span> <span class="sh_number">1</span> end<span class="sh_symbol">]</span>
    vtal<span class="sh_number">.</span>showstack
    <a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_cbracket">{</span><span class="sh_variable">$_v</span> ne <span class="sh_string">""</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/upvar" class="sh_keyword">upvar</a> <span class="sh_number">1</span> <span class="sh_variable">$_v</span> var<span class="sh_symbol">;</span> <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> var <span class="sh_variable">$res</span><span class="sh_cbracket">}</span>
    <a href="https://wiki.tcl-lang.org/page/return" class="sh_keyword">return</a> <span class="sh_variable">$res</span>
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> push what <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/global" class="sh_keyword">global</a> g
    <a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> g<span class="sh_symbol">(</span>stack<span class="sh_symbol">)</span> <span class="sh_symbol">[</span>linsert <span class="sh_variable">$g</span><span class="sh_symbol">(</span>stack<span class="sh_symbol">)</span> <span class="sh_number">0</span> <span class="sh_variable">$what</span><span class="sh_symbol">]</span>
    vtal<span class="sh_number">.</span>showstack
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span>showstack <span class="sh_cbracket">{}</span> <span class="sh_cbracket">{</span>
    <a href="https://wiki.tcl-lang.org/page/global" class="sh_keyword">global</a> g
    <span class="sh_variable">$g</span><span class="sh_symbol">(</span>stk<span class="sh_symbol">)</span> delete <span class="sh_number">1.0</span> end
    <span class="sh_variable">$g</span><span class="sh_symbol">(</span>stk<span class="sh_symbol">)</span> insert <span class="sh_number">1.0</span> <span class="sh_symbol">[</span><a href="https://wiki.tcl-lang.org/page/join" class="sh_keyword">join</a> <span class="sh_variable">$g</span><span class="sh_symbol">(</span>stack<span class="sh_symbol">)</span> <span class="sh_symbol">\</span>n<span class="sh_symbol">]</span>
<span class="sh_cbracket">}</span>
<a href="https://wiki.tcl-lang.org/page/proc" class="sh_keyword">proc</a> vtal<span class="sh_number">.</span>hilite <span class="sh_cbracket">{</span>w line<span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span>
    <span class="sh_variable">$w</span> tag remove hilite <span class="sh_number">1.0</span> end
    <span class="sh_variable">$w</span> tag add hilite <span class="sh_variable">$line</span><span class="sh_number">.0</span> <span class="sh_variable">$line</span><span class="sh_number">.</span>end<span class="sh_symbol">+</span>1c
    <span class="sh_variable">$w</span> see <span class="sh_variable">$line</span><span class="sh_number">.0</span>
<span class="sh_cbracket">}</span>

vtal
<span class="sh_comment">#-- demo function for starters</span>
<span class="sh_comment">#vtal.refresh {{x y} {expr {$x%2? acos(-1) : sqrt(2)}}}</span>
<span class="sh_comment">#vtal.refresh {x {foreach i $x {puts ($i)}}}</span>
vtal<span class="sh_number">.</span>refresh <span class="sh_cbracket">{</span>x <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> res <span class="sh_cbracket">{}</span><span class="sh_symbol">;</span><a href="https://wiki.tcl-lang.org/page/foreach" class="sh_keyword">foreach</a> i <span class="sh_variable">$x</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/if" class="sh_keyword">if</a> <span class="sh_cbracket">{</span><span class="sh_variable">$i</span><span class="sh_symbol">&gt;</span><span class="sh_number">0</span><span class="sh_cbracket">}</span> <span class="sh_cbracket">{</span><a href="https://wiki.tcl-lang.org/page/lappend" class="sh_keyword">lappend</a> res <span class="sh_variable">$i</span><span class="sh_cbracket">}}</span><span class="sh_symbol">;</span><a href="https://wiki.tcl-lang.org/page/set" class="sh_keyword">set</a> res<span class="sh_cbracket">}}</span>
</pre></div><hr><div class="mkup_centered"><table class="mkup_categories"><tbody><tr><td class="mkup_td"><a class="mkup_a" href="https://wiki.tcl-lang.org/page/Category+Internals">Category Internals</a></td></tr></tbody></table></div>
</div>
</div>
<div class="row">
<div class="col-xs-12">
<div class="Footer">Updated 2019-02-11 07:41:36</div>
</div>
</div>
</div>

<script src="./Visual TAL_files/jquery.min.js"></script>
<script src="./Visual TAL_files/jquery.tablesorter.combined.js"></script>

<script src="./Visual TAL_files/bootstrap.min.js"></script>
<script type="text/javascript" src="./Visual TAL_files/nikit.js"></script>
<script type="text/javascript" src="./Visual TAL_files/sh_main.js"></script>
<script type="text/javascript" src="./Visual TAL_files/sh_tcl.js"></script>
<script type="text/javascript" src="./Visual TAL_files/sh_c.js"></script>
<script type="text/javascript" src="./Visual TAL_files/sh_cpp.js"></script>

<script src="./Visual TAL_files/api.js"></script>
<script>var clipboard = new ClipboardJS('.copybtn', {
  text: function(trigger) {
    return document.querySelector(trigger.getAttribute('data-clipboard-target')).textContent + '\n';
  }
});
sort_tables();
</script>


</body></html>