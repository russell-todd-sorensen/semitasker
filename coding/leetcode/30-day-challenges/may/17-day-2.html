<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8" >

<title>LeetCode 30-Day Challenge: Day 17</title>
<!--
Find All Anagrams in a String

Given a string s and a non-empty string p, find all the 
start indices of p's anagrams in s.

Strings consists of lowercase English letters only and 
the length of both strings s and p will not be larger 
than 20,100.

The order of output does not matter.

Example 1:

Input:
s: "cbaebabacd" p: "abc"

Output:
[0, 6]

Explanation:
The substring with start index = 0 is "cba", which is an anagram of "abc".
The substring with start index = 6 is "bac", which is an anagram of "abc".

Example 2:

Input:
s: "abab" p: "ab"

Output:
[0, 1, 2]

Explanation:
The substring with start index = 0 is "ab", which is an anagram of "ab".
The substring with start index = 1 is "ba", which is an anagram of "ab".
The substring with start index = 2 is "ab", which is an anagram of "ab".
-->
<script>
/**
 * @param {string} s
 * @param {string} p
 * @return {number[]}
 */

var findAnagrams = function(s, p) {

    let sLen  = s.length,
        pLen  = p.length,
        zeroA = {sIdx:0,len:0,chars:{}},
        endA  = {sIdx:0,len:pLen,chars:{}},
        stack = [],
        results = [],
        char  = null,
        tchar = null;

    for (let i=0;i<pLen;i++) {
        char = p[i];
        if (endA.chars[char]) {
            endA.chars[char]++
        } else {
            zeroA.chars[char] = 0;
            endA.chars[char] = 1;
        }
    }

    for (let i=0;i<sLen;i++) {
        char = s[i];
        if (stack.length < pLen) { //try to add
            if (endA.chars[char]) {
                if (zeroA.chars[char] < endA.chars[char]) {
                    zeroA.chars[char]++
                    stack.push(char)
                } else {
                    while (stack.length && zeroA.chars[char] == endA.chars[char]) {
                        tchar = stack.shift();
                        zeroA.chars[tchar]--;
                    }
                    stack.push(char);
                    zeroA.chars[char]++;
                    continue;
                }
                if (stack.length == pLen) {
                    results.push(i-pLen+1);
                    tchar = stack.shift();
                    zeroA.chars[tchar]--;
                }
            } else {
                while (stack.length) {
                    tchar = stack.shift();
                    zeroA.chars[tchar]--
                }
            }
        } else {
            console.log(stack);
            break;
        }
    }

    return results;
};


</script>
</head>
<body>
<pre>

</pre>
</body>
</html>


