<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8" >
<base href="https://home.semitasker.com/">
<title>CPC-CHALLENGE MULT-BUTTON</title>
<style>
    @import url('https://fonts.googleapis.com/css?family=Cute+Font|Days+One|ZCOOL+QingKe+HuangYou&display=swap');
</style>
<style>
#body {
    font-family: 'ZCOOL QingKe HuangYou';
    font-family: 'cute font';
    font-family: 'days one';
    font-size: 2vw;
    margin: .8vw;
}

#button-bar {
    display: inline-block;
    width: 5vw;
    justify-content: space-evenly;
    position: relative;
}

#button-bar input {
    display: block;
    font-size: 1.75vw;
    padding-left: .6vw;
    padding-right: .6vw;
    padding-top: .1vw;
    padding-bottom: .1vw;
    border-width: .1vw;
}

button, input, select, textarea {
    font-family: inherit;
    font-size: 100%;
    box-sizing: border-box;
}

#source {
    cursor:cell;
    caret-color: red;
}

.pre,
#selection,
#copy-buffers {
    padding: .5vw;
    border-width: .1vw;
    display: inline-block;
    width: 45vw;
    min-height: 20vh;
    background-color: #bbb;
    font-family: 'ZCOOL QingKe HuangYou';
    font-size: 2vw;
    vertical-align: top;
    letter-spacing: .1em;
}

#selection,
#copy-buffers {
    background-color: #ccc;
    border-width: .1vw;
    font-size: 2vw;
    color: brown;
    border-color: black;
    border-style: solid;
    min-height: 5vh;
    cursor: pointer;
    box-sizing: border-box;
}

#copy-buffers {
    padding-top: 0;
}

.copy-buffer {
    display: block;
    height: 1.3em;
}

.current-buffer {
    color: green;
    padding-top: .35em;
}

.copy-buffer span { 
    background-color: rgba(255,0,0,.2);
    padding: .1vw;
    padding-left: .3vw;
    padding-right: .2vw;
    border: .1vw solid rgba(0,0,0,.25);
    border-radius: 50%;
    align-content:center;
}

.current-buffer span {
    background-color: rgba(0,255,0,.2);
}

#button-bar input {
    width: 100%;
    display: block;
    -webkit-transition: height 1s, padding 1s, border 1s; /* For Safari 3.1 to 6.0 */
    transition: height 1s, padding 1s, border 1s;
    background-color: #ddc;
    color: #ddc;
    text-shadow:1px 1px 1.2em rgba(0,0,0,.9),
                -1px -1px 1.2em rgba(0,0,0,.9),
                -1px 1px 1.2em rgba(0,0,0,.9),
                 1px -1px 1.2em rgba(0,0,0,.9);

}

.inner-shadow {
    text-shadow:1px 1px 10px rgba(0,0,0,.9),
                -1px -1px 10px rgba(0,0,0,.9),
                -1px 1px 10px rgba(0,0,0,.9),
                 1px -1px 10px rgba(0,0,0,.9);
}

#button-bar input.enabled {
    display: block;
    transition-delay: 0s;
    transition-timing-function: cubic-bezier(0.99, -0.15, 0.74, 1.26);
    width: 1.5em;
    height: 1.5em;
    border: none;
}

#button-bar #top,
#button-bar #bottom {
    height: .75em;
    border: none;
}

#button-bar input.disabled {
    transition-timing-function: cubic-bezier(0.99, -0.15, 0.74, 1.26);
    display: flexbox;
    width: 1.5em;
    height: 0;
    padding: 0;
    border: none;
    margin:0;
}

#copy-cut-tab {
    width: 45%;
    border: 1px solid orange;
}

#prs-tab-group {
    width: 45%;
    border: 1px solid green;
}

#copy-cut-tab,
#prs-tab-group,
#paste-tab,
#replace-swap-tab {
    display: block;
    margin: auto;
    align-items:center;
}
#top,
#paste,
#replace,
#swap,
#bottom {
    margin: 0;
    text-align: center;
}

#button-bar #top,
#button-bar #bottom {
    background-color: rgba(0,0,0,.3);
}

#scroll-buffer {
    display: inline-flex;
}
/*
    To get pill shape no matter what, use first-of-type and last-of-type
    .enabled buttons to apply 50% top or bottom border-radius.
*/
#button-bar input.enabled:first-of-type {
    border-top-left-radius: 50%;
    border-top-right-radius: 50%;
}
#button-bar input.enabled:last-of-type {
    border-bottom-left-radius: 50%;
    border-bottom-right-radius: 50%;
}

#instructions {
    font-family: "Days One";
    font-size: 1em;
    font-weight: 100;
}
</style>
</head>
<body>
<div id="body">
<form  autocomplete="off" spellcheck="false" onsubmit="return false;" >
<div id="side-by-side">
<textarea class="pre" id="source" name="source"
          onKeyUp="updateContent()"
          onFocus="updateContent();"
          >This is a system of the broadcast test emergency.</textarea>
<div id="button-bar">
    <input type="button" class="enabled" id="top" name="top" value="_" />
    <input type="button" id="copy" name="copy" value="C"
           onClick="copySelection();" />
    <input type="button" id="cut" name="cut" value="X"
           onClick="copyCutSelection();"
           onMouseOver="previewCut('source','preview')"/>
    <input type="button" id="paste" name="paste" value="P"
           onClick="pasteBuffer()" />
    <input type="button" id="replace" name="replace" value="R"
           onClick="replaceSelectionWithBuffer()" />
    <input type="button" id="swap" name="swap" value="S"
           onClick="swapSelectionWithBuffer()"/>
    <input type="button" class="enabled" id="bottom" name="bottom" value="_" />
</div><!-- end button bar   -->
<div id="scroll-buffer"></div>
</div><!-- end side-by-side -->
<div id="buffer-display">
 <div id="selection"></div>
 <div id="copy-buffers"></div>
</div>

</form>
</div>
<div id="instructions">
    <h3>Multi-Multi-Button</h3>
    <p>This button integrates copy, cut, paste, replace and swap. Only
        allowable operations are displayed depending on whether text is 
        selected and if text is available to paste from the buffer. 
        <ul>
            <li>Copy: places a copy of the selected text into a new buffer.</li>
            <li>Cut: first does a Copy, then cuts the text from the texarea.</li>
            <li>Paste: Inserts selected buffer at caret position.</li>
            <li>Replace: Replaces selected text with selected buffer, selected
                text is lost.</li>
            <li>Swap: Swaps selected text with text in selected buffer.</li>
        </ul>
    </p>
    <p>
        When multiple buffers are available you can use mouse scroll to cycle among
        the options.
    </p>
    <h3>Test Sequence: This is a test of the emergency broadcast system.</h3>
    <p>You can try this sequence of operations to get an idea of how this works.
        <ol>
            <li>
                You may have to allow updating or reading your global clipboard.
                What is in your clipboard when you load the page will get turned into 
                a buffer. You can delete this buffer by clicking on the X at the end.
            </li>
            <li>
                Select " test" and click on the 
                <input type="button" class="enabled" id="x-button" value="X" />
                button. This yanks the text into a buffer.
            </li>
            <li>
                Select " system" and click on the 
                <input type="button" class="enabled" id="s-button" value="S" />
                button. This swaps the two strings.
            </li>
            <li>
                Select " emergency", and then click the 
                <input type="button" class="enabled" id="x-button" value="X" />
                button. There are now two buffers.
            </li>
            <li>
                Now click between "the" and "broadcast", and click the only option left 
                <input type="button" class="enabled" id="p-button" value="P" />,
                pasting emergency.
            </li>
            <li>
                There are still two buffers so you can place the pointer over the buttons
                and mouse scroll to select the other buffer (_system).
            </li>
            <li>
                Place the caret right before the period and click the 
                <input type="button" class="enabled" id="p-button" value="P" />.
            </li>
            <li>
                Finally select everything after test and before the period and click
                on the <input type="button" class="enabled" id="r-button" value="R" />,
                producing a final string of "This is a test system."
            </li>
        </ol>
    </p>
</div>
<script src="/js/copy-paste-edit-transitions.js"></script>
<script>
var scrollRef1
window.addEventListener('DOMContentLoaded', () => {
    readFromClipboard(buttonState.sourceId);
    document.getElementById('paste').onmouseover = showActiveBuffer;
});

var scrollValues = new Array();

scrollValues[0] = {
    value:0,
    id:'scroll-buffer',
    wheelId:'button-bar'
};

var handleScrollBuffers = function (evt) {
    //evt.cancelBubble = true;
    //evt.preventDefault = true;
    let wheelDelta = evt.wheelDelta;
    console.log('In handleScrollBuffers timestamp: '
        + evt.timeStamp
        + ', wheelDelta='
        + wheelDelta);
    let index = copyBufferIndex;
    let len = copyBuffer.length
    if (len == 0) {
        return false;
    }
    while (index < 0) {
        index += len
    }
    let bufferRef = copyBuffer[index]

    if (wheelDelta < 0) {
        index = (index + 1) % len
    } else {
        index = (index - 1) % len
    }
    while (index < 0) {
        index += len; 
    }
    copyBufferIndex = index;
    renderBuffers(copyBufferIndex);
    return false;
}

</script>
</body>
</html>
