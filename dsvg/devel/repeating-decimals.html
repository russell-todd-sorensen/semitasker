<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8" >

<title></title>
<style>
.red {
    color: red;
}
td {
    text-align: right;
    font-family:'Lucida Sans Unicode', monospace;
}
td.al {
    text-align: left;
}
tr.hl {
    background-color: rgb(255,200,200);
}
td.er {
    background-color: rgb(255,100,255);
}
tr.ec2 {
    background-color: rgba(255,0,0,0.5);
}
</style>
<script src="/js/base-conversion.js"></script>
<script src="/js/fraction-to-recurring-decimal.js"></script>
<script src="/chemical-pi/js/pi-digits.js"></script>
<script src="/js/math.js"></script>
<script src="/js/x2-test.js"></script>
<script>

var toggleStyle = function (evt) {
    let styleClass = this.className
    if (styleClass == 'hl') {
        this.className = ""
    } else {
        this.className = 'hl'
    }
}

let setClickEvents = function (evt) {
    let rows = document.getElementsByTagName('tr');
    let row;
    for (let i in rows) {
        row = rows[i];
        row.onclick = toggleStyle
    }
}

var runTests2 = function (begin,end,nbegin,nend,maxMatch,maxOutput) {

    begin  = (begin || 2);
    end    = (end || 100);
    nbegin = (nbegin || 1);
    nend   = (nend || 1);
    maxMatch = (maxMatch || -1);
    maxOutput = (maxOutput || 10000);
    output = `<table cellspacing='0' cellpadding='2' border='1px'>
    <tr><th>Numer</th><th>Denom</th><th>Head<th>preMatch</th><th>RepLen</th>
    <th>MatchLen</th><th>Divide</th><th>Reduced</th><th>Factored</th><th>Result</th>
    </tr>`;

    let bc,head,preMatch,matchLen,result,div,repLen,numer;
    let doNotReduce = true;
    let failed = false;
    let rational;
    let maxCounter = 0;
    bigloop:
    for (let n = nbegin;n<=nend;n++) {
        numer = n
        for (i=begin;i<=end;i++) {
            if (maxCounter >= maxOutput) {
                break bigloop;
            }
            errorClass = "";
            rowErrorClass = "";
            denom = i;
            bc = fractionToRecurringDecimal(n,denom,doNotReduce);
            rational = new Rational(numer,denom);
            matchLen = bc.matchLen;
            result = bc.res;
            head = bc.head;
            preMatch = bc.preMatch;
            repLen = bc.repLen;
            div = bc.div;
            if (bc.err != "" || bc.res == "") {
                errorClass = "ec";
            }
            else {
                errorClass = "";
            }
            if (bc.matchLen == 0) {
                rowErrorClass = "ec2";
            }  else {
                rowErrorClass = "";
            }
            output += `
        <tr id='r-${i}' class='${rowErrorClass}'><td>${numer}</td><td>${denom}</td>
            <td>${head}</td><td>${preMatch}</td><td>${repLen}</td>
            <td>${matchLen}</td>
            <td class='al${errorClass}'>${div}</td>
            <td >${rational.rationalValue}</td>
            <td >${rational.factoredValue}</td>
            <td class='al${errorClass}'>${result}</td>
        </tr>\n`;
            maxCounter++;
        }
    }
    document.getElementById('results').innerHTML = output;
    setClickEvents(event);
}

var normInteger = function (inString) {
    let sign = (inString[0] == "-" ? -1 : 1);
    if (sign == -1) {
        inString = inString.substr(1);
    }
    let exp = inString.length,
        sd,
        sv,
        i = exp-1; 
    while (i >= 0 && inString[i] == 0) {
        // loop
        i--;
    }
    sv = inString.slice(0,i+1);
    sd = sv.length;
    return {sign:sign,inString:inString,sv:sv,sd:sd,i:i,len:exp};
}

let normFloat = function(numer, denom) { // numer and denom both integers
    let sign, reducedFraction, reducedNumer, 
        reducedDenom, numExp,exponent,maxSigDig,
        denomFactors,numerFactors;

    let numerSign = (numer < 0 ? -1 : 1),
        denomSign = (denom < 0 ? -1 : 1),
        resultSign = numerSign * denomSign;

    denom *= denomSign;
    numer *= numerSign;

    numerFactors = factorInteger(numer);
    denomFactors = factorInteger(denom);
    reducedFraction = reduceFraction(numerFactors,denomFactors);
}

</script>
</head>
<body>
<div id="form-container">
<form action="" method="GET" id="form1">
<ul>
 <li>
    <label for="nb">Numerator Begin:</label>
    <input id="nb" name="nb" max="8888888888888888" type="number">
</li>
<li>
   <label for="ne">Numerator End:</label>
   <input id="ne" name="ne" type="number" max="8888888888888888">
</li>
<li>
   <label for="db">Denominator Begin:</label>
   <input id="db" name="db" type="number" max="88888888">
</li>
<li>
   <label for="de">Denominator End:</label>
   <input id="de" name="de" type="number" max="88888888">
</li>
<li>
   <label for="submit">Submit:</label>
   <input id="submit" name="submit" type="submit" value="Submit">
</li>
</ul>
</form>
</div>
<div id="results"></div>
<pre>
failing fractions:
 12953/50284 = 25759684989260997534006841142311669716013045899292 rf-calc = .25759684989261 actual = much longer...
 NOTE on Above: .2575968498926099 rounds to 25759684989261
 Need to start ignoring internal division 
</pre>
<h3>But Here's a Simple Solution:</h3>
<p><a href="repeating-decimals.html?nb=12950&ne=12960&db=50284&de=50284&submit=Submit">Click to visit:</a></p>
<div id="results">
    <table cellspacing="0" cellpadding="2" border="1px">
    <tbody><tr class=""><th>Numer</th><th>Denom</th><th>Head</th><th>preMatch</th><th>RepLen</th>
    <th>MatchLen</th><th>Divide</th><th>Reduced</th><th>Factored</th><th>Result</th>
    </tr>
        <tr id="r-50284"><td>12950</td><td>50284</td>
            <td>0</td><td>2</td><td>100603</td>
            <td>966</td>
            <td class="al">257537188767798</td>
            <td>6475/25142</td>
            <td>5<sup>2</sup>*7*37/2*13*967</td>
            <td class="al">0.2(575371887677989022353034762548723251929043035558030387399570439901360273645692466788640521835971680852756343966271577440140004772889984885848381194813459549757378092434969373955930315806220666613634555723490573542279850449447140243417389229178267440935486437037626282714183438071752446106117253997295362341898019250656272372921804152414286850688091639487709808288918940418423355341659374751411979953862063479436798981783469891019012011773128629385092673613873200222734865961339591122424628112322010977646965237451276748070956964441969612600429560098639726354307533211359478164028319147243656033728422559859995227110015114151618805186540450242621907565030626044069684193779333386365444276509426457720149550552859756582610770821732559064513562962373717285816561928247553893882746002704637658101980749343727627078195847585713149311908360512290191711081059581576644658340625248588020046137936520563201018216530108980987988226871370614907326386126799777265134038660408877)</td>
        </tr>

        <tr id="r-50284"><td>12951</td><td>50284</td>
            <td>0</td><td>25</td><td>100603</td>
            <td>966</td>
            <td class="al">2575570758094025</td>
            <td>12951/50284</td>
            <td>3<sup>2</sup>*1439/2<sup>2</sup>*13*967</td>
            <td class="al">0.25(755707580940259327022512131095378251531302203484209688966669318272213825471322886007477527642987829130538541086627953225678148118685864290828096412377694694137300135231882905099037467186381353909792379285657465595418025614509585554052979078832232917031262429401002306896826028160050910826505449049399411343568530745366319306339988863256701933020443878768594383899451117651738127436162596452151777901519369978521995068013682284623339432026091798584042637817198313578872007000238644499244292419059740672977487868904621748468697796515790311033330681727786174528677113992522472357012170869461458913372046774321851881314135709171903587622305305862699864768117094900962532813618646090207620714342534404581974385490414445947020921167767082968737570598997693103173971839949089173494550950600588656431469254633680693660011136743298066979556121231405616100548882348261872563837403547848222098480630021478004931986317715376660567973908201415957362182801686421127992999761355500)</td>
        </tr>

        <tr id="r-50284"><td>12952</td><td>50284</td>
            <td>0</td><td></td><td>100603</td>
            <td>966</td>
            <td class="al">257576962851006</td>
            <td>3238/12571</td>
            <td>2*1619/13*967</td>
            <td class="al">0.(257576962851006284305146766367035239837721740513881155039376342375308249144857211041285498369262588497335136425105401320499562485084718797231723808766207938907008193461140720706387717763105560416832392013364091957680375467345477686739320658658817914247076604884257417866518176756025773605918383581258451992681568689841699148834619362023705353591599713626600906849097128311192427014557314453901837562644181051626760003181926656590565587463208973033171585394956646249303953543870813777742423037148993715694853233632964760162278259486118844960623657624691750855142788958714501630737411502664863574894598679500437514915281202768276191233792061092991806538859279293612282236894439583167607986635908042319624532654522313260679341341182085752923395115742582133481823243974226394081616418741548007318431310158300851165380637976294646408400286373399093150902871688807572985442685546098162437355818948373239996818073343409434412536791026966828414605043353750696046456129186222)</td>
        </tr>

        <tr id="r-50284" class="ec2"><td>12953</td><td>50284</td>
            <td>0</td><td></td><td>100603</td>
            <td>0</td>
            <td class="al">0.25759684989261</td>
            <td>12953/50284</td>
            <td>12953/2<sup>2</sup>*13*967</td>
            <td class="al">0.25759684989261</td>
        </tr>

        <tr id="r-50284"><td>12954</td><td>50284</td>
            <td>0</td><td>2</td><td>100603</td>
            <td>966</td>
            <td class="al">2576167369342136</td>
            <td>6477/25142</td>
            <td>3*17*127/2*13*967</td>
            <td class="al">0.2(576167369342136663749900564791981544825391774719592713387956407604804709251451754037069445549280089093946384535836448969851244928804391058786094980510699228382785776787845040171824039455890541723013284543791265611327658897462413491369023943998090844006045660647522074616180097048763026012250417627873677511733354546177710603770583088059820221143902633044308328693023625805425184949486914326624771299021557553098401081855063240792299737491050831278339034285259724763344204916076684432423832630657863336250099435208018455174608225280407286612043592395195290748548245962930554450719910906053615464163551030148755071195608941213905019489300771617214223212154959828175960544109458276986715456208734388672341102537586508630976056001909155993954339352477925383819902951236973987749582372126322488266645453822289396229416911940179778856097366955691671306976374194574815050513085673375228700978442446901598918144936759207700262508949168721660965714740275236655795083923315567)</td>
        </tr>

        <tr id="r-50284"><td>12955</td><td>50284</td>
            <td>0</td><td>25</td><td>100603</td>
            <td>966</td>
            <td class="al">257636623975817</td>
            <td>12955/50284</td>
            <td>5*2591/2<sup>2</sup>*13*967</td>
            <td class="al">0.25(763662397581735740991170153527961180494789595099832948850528995306658181528915758491766764776071911542438946782276668522790549677829926020205234269350091480391376978760639567257974703683080105003579667488664386285896110094662318033569326227030466947736854665499960225916792617930156709887837085355182563041921883700580701614827778219712035637578553814334579587940497971521756423514437992204279691353114310715138016068729615782356216689205313817516506244531063558984965396547609577599236337602418264259008829846472038819505210404900167051149471004693341818471084241508233235223928088457561053217723331477209450322170073979794765730649908519608623021239360432742025296316919894996420332511335613714103889905337681966430673772969533052263145334500039774083207382069843290112162914644817436958078116299419298385172221780287964362421446185665420412059502028478243576485562007795720308646885689284861983931270384217643783310794686182483493755468936441015034603452390422400)</td>
        </tr>

        <tr id="r-50284"><td>12956</td><td>50284</td>
            <td>0</td><td></td><td>100603</td>
            <td>966</td>
            <td class="al">2576565110174210</td>
            <td>3239/12571</td>
            <td>41*79/13*967</td>
            <td class="al">0.(257656511017421048444833346591361069127356614430037387638214939145652692705433139766128390740593429321454140482061888473470686500676159414525495187335931906769548961896428287327977090128072547927770264895394161164585156312147005011534484130140800254554132527245246997056717842653726831596531699944316283509665102219393842971919497255588258690637180812982260758889507596849892609975340068411423116697160130458992920213189085991567894360035001193222496221462095298703364887439344523108742343488982578951555166653408638930872643385569962612361785060854347307294566860233871609259406570678545859517938111526529313499323840585474504812664068093230451038103571712672022909871927452072229735104605838835414843687852994988465515869859199745445867472754753002943282157346273168403468300055683716490334897780606157028080502744411741309362819187017739241110492403150107390024659931588576883302839869541007079786810914008432105639964998806777503778537904701296635112560655476891)</td>
        </tr>

        <tr id="r-50284"><td>12957</td><td>50284</td>
            <td>0</td><td>25</td><td>100603</td>
            <td>966</td>
            <td class="al">2576763980590247</td>
            <td>12957/50284</td>
            <td>3*7*617/2<sup>2</sup>*13*967</td>
            <td class="al">0.25(767639805902473947975499164744252644976533290907644578792458833823880359557712194733911383342613952748389149630101026171346750457401956884893803197836289873518415400525017898337443321931429480550473311590167846631135152334738684273327499801129583963089650783549439185426775912815209609418502903508074138891098560178187892769071672897939702489857608782117572189961021398456765571553575690080343648078911781083446026569087582531222655317794924826982738047887996181688012091321295044149232360194097526052024500835255747355023466709092355421207541166176119640442287805266088616657386047251610850369898973828653249542598043115106196802163710126481584599474982101662556678068570519449526688409832153368864847665261315726672500198870416036910349216450560814573224087184790390581497096491925861108901439821812107230928327102060297510142391217882427810038978601543234428446424309919656351921088218916553973430912417468777344682205075173017261952112003818311987908678704955850)</td>
        </tr>

        <tr id="r-50284"><td>12958</td><td>50284</td>
            <td>0</td><td>2</td><td>100603</td>
            <td>966</td>
            <td class="al">257696285100628</td>
            <td>6479/25142</td>
            <td>11*19*31/2*13*967</td>
            <td class="al">0.2(576962851006284305146766367035239837721740513881155039376342375308249144857211041285498369262588497335136425105401320499562485084718797231723808766207938907008193461140720706387717763105560416832392013364091957680375467345477686739320658658817914247076604884257417866518176756025773605918383581258451992681568689841699148834619362023705353591599713626600906849097128311192427014557314453901837562644181051626760003181926656590565587463208973033171585394956646249303953543870813777742423037148993715694853233632964760162278259486118844960623657624691750855142788958714501630737411502664863574894598679500437514915281202768276191233792061092991806538859279293612282236894439583167607986635908042319624532654522313260679341341182085752923395115742582133481823243974226394081616418741548007318431310158300851165380637976294646408400286373399093150902871688807572985442685546098162437355818948373239996818073343409434412536791026966828414605043353750696046456129186222257)</td>
        </tr>

        <tr id="r-50284"><td>12959</td><td>50284</td>
            <td>0</td><td>25</td><td>100603</td>
            <td>966</td>
            <td class="al">2577161721422321</td>
            <td>12959/50284</td>
            <td>12959/2<sup>2</sup>*13*967</td>
            <td class="al">0.25(771617214223212154959828175960544109458276986715456208734388672341102537586508630976056001909155993954339352477925383819902951236973987749582372126322488266645453822289396229416911940179778856097366955691671306976374194574815050513085673375228700978442446901598918144936759207700262508949168721660965714740275236655795083923315567576167369342136663749900564791981544825391774719592713387956407604804709251451754037069445549280089093946384535836448969851244928804391058786094980510699228382785776787845040171824039455890541723013284543791265611327658897462413491369023943998090844006045660647522074616180097048763026012250417627873677511733354546177710603770583088059820221143902633044308328693023625805425184949486914326624771299021557553098401081855063240792299737491050831278339034285259724763344204916076684432423832630657863336250099435208018455174608225280407286612043592395195290748548245962930554450719910906053615464163551030148755071195608941213905019489300)</td>
        </tr>

        <tr id="r-50284"><td>12960</td><td>50284</td>
            <td>0</td><td></td><td>100603</td>
            <td>966</td>
            <td class="al">257736059183835</td>
            <td>3240/12571</td>
            <td>2<sup>3</sup>*3<sup>4</sup>*5/13*967</td>
            <td class="al">0.(257736059183835812584519926815686898416991488346193620237053535915997136266009068490971283111924270145573144539018375626441810516267600031819266565905655874632089730331715853949566462493039535438708137777424230371489937156948532336329647601622782594861188449606236576246917508551427889587145016307374115026648635748945986795004375149152812027682761912337920610929918065388592792936122822368944395831676079866359080423196245326545223132606793413411820857529233951157425821334818232439742263940816164187415480073184313101583008511653806379762946464084002863733990931509028716888075729854426855460981624373558189483732399968180733434094344125367910269668284146050433537506960464561291862222575769628510062843051467663670352398377217405138811550393763423753082491448572110412854983692625884973351364251054013204995624850847187972317238087662079389070081934611407207063877177631055604168323920133640919576803754673454776867393206586588179142470766048842574178665181767560)</td>
        </tr>
</tbody></table></div>

<script>

var queryValues = {
    nb: 1,
    ne: 1,
    db: 1,
    de: 1,
}

var processForm = function() {

    let url = document.URL;
    let query = url.split("?")[1]
    if (query) {
        let terms = query.split("&");
        let term;
        if (terms.length) {
            terms.forEach(element => {
                term = element.split("=")
                queryValues[term[0]] = term[1]
            });
        }
    }
    runTests2(queryValues.db,queryValues.de,queryValues.nb,queryValues.ne, 5000);
    nb.value = queryValues.nb;
    ne.value = queryValues.ne;
    db.value = queryValues.db;
    de.value = queryValues.de;
}

processForm();
</script>
</body>
</html>
