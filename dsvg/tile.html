<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8" >
<base href="https://home.semitasker.com/">
<link rel="stylesheet" href="/dsvg/css/tile.css" />
<script src="/js/d3.v3.js"></script>
<script src="/dsvg/js/tile.js" ></script>
<title>SVG Tile Generator</title>
</head>
<body onload="initHTML()">
<object 
    id="mset"
    style="display:none"
    onload="initSVG()"
    type="image/svg+xml"
    data="/dsvg/tile.svg?bc=90&ec=125&br=30&er=52&nc=1&fs=48"
    height="100%"
    width="100%">
</object>
<script>

var fontFamily;
var SVGObject,SVGData,SVGDoc,SVGRoot,svgns = "http://www.w3.org/2000/svg";
var optionHTML = ""
var fontArray = [];

var initHTML = function() {
    let newURL,url,query,SVGQuery;
    let queryArray = document.URL.split('?')
    if (queryArray.length == 2) {
        query = queryArray[1]
    } else {
        query = ""
    }
    url = queryArray[0]
    SVGObject = document.getElementById('mset')
    SVGData = SVGObject.data.split('?')
    let svgURL  = SVGData[0]

    if (SVGData.length == 2) {
        SVGQuery = SVGData[1]
    } else {
        SVGQuery = ""
    }

    if (query != SVGQuery) {
        if (query == "") {
            newURL = SVGData[0]
        } else {
            newURL = SVGData[0] + "?" + query;
        }
        SVGObject.data = newURL; //note: this will refresh the SVG Document
    }

    loadGoogleFontList('fontFamily',[]);
}

var initSVG = function() {
    SVGObject = document.getElementById('mset')
    SVGDoc    = SVGObject.getSVGDocument();
    SVGRoot   = SVGDoc.documentElement;
};

var loadGoogleFontList = function(selectId,fontArray) {
    fetch(
        "/dsvg/fonts/fonts.txt"
    ).then(
        (res) => res.text()
    ).then(
        (text) => {
            text = "'Arial', sans-serif\n" + text
            let dict = text.split("\n").sort();
            let fontString,font,trimmed,formattedNumber,lowercase;
            top.optionHTML = ""
            for (let i=0;i<dict.length;i++) {
                fontString = dict[i];
                font = fontString.split(",")[0];
                formattedNumber = "&nbsp;".repeat(3-("" + i).length) + i;
                trimmed = font.slice(1,font.length-1)
                lowercase = trimmed.toLowerCase()
                top.fontArray[lowercase] = i
                top.optionHTML = top.optionHTML
                    + "\n"
                    + "<option value=\""
                    + font
                    + "\">"
                    + formattedNumber
                    + ": "
                    + trimmed
                    + "</option>";
            }
            d3.select('#' + selectId).html(top.optionHTML);
            SVGObject.style["display"] = "block";
        }
    );
}

</script>
<div id="form-container">
<form id="form1">
<fieldset>
<legend style="cursor: pointer">B, W &amp; A Image Options</legend>
<ul id="panel">
<li class="expand">
<label for="fontSize" class="dual-input-type">Font Size:</label>
<div class="min-max">
<span id="font-size-min"></span>
<input id="fontSize" name="fontSize" type="range"
    min="5" max="100" step="0.1"
    onChange="changeFontSize('fontSize','t2')"
    onBlur="changeFontSize('fontSize','t2')">
<span id="font-size-max"></span>
</div>
</li>
<li class="expand">
<label for="fontFamily">Font:</label>

<select name="fontFamily" id="fontFamily"
    style="border-right-width:3px;"
    onChange="changeFontFamily('fontFamily','t2');">
</select>
</li>
</ul>
</fieldset>
</form>
</div>
</body>
</html>