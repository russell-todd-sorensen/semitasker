<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8" >

<base href="https://home.semitasker.com/">
<title>SVG Gears: Fast and Slow</title>
</head>
<body>
<script src="https://unpkg.com/transformation-matrix@2"></script>
<script>

class matrixTransform {
    constructor (t) {

        this.a = (t.a?t.a:0);
        this.b = (t.b?t.b:0);
        this.c = (t.c?t.c:0);
        this.d = (t.d?t.d:0);
        this.e = (t.e?t.e:0);
        this.f = (t.f?t.f:0);
        this.t = {
            a:this.a,
            b:this.b,
            c:this.c,
            d:this.d,
            e:this.e,
            f:this.f
        };
    }
    toString() {
        return `matrix(${this.a},${this.b},${this.c},${this.d},${this.e},${this.f})`
    }
    transformPoint(p) {
        let x = (p.x?p.x:0)
        let y = (p.y?p.y:0)

        return {
            x:this.a*x + this.c*y + this.e,
            y:this.b*x + this.d*y + this.f
        }
    }
    transformPoints(points) {
        let tPoints = [];
        for (let i=0;i<points.length;i++) {
            tPoints.push(this.transformPoint(points[i]));
        }
        return tPoints;
    };
    apply(id) {
        let element = document.getElementById(id);
        element.setAttribute('transform',this.toString())
    };
}

</script>
<svg viewBox="-1000 -1000 2000 2000" xmlns="http://www.w3.org/2000/svg" x="-1000" y="-1000" height="2000" width="2000">
 
   
    <!--
    In the following example we are applying the matrix:
    [a c e]    [3 -1 30]
    [b d f] => [1  3 40]
    [0 0 1]    [0  0  1]
  
    which transform the rectangle as such:
  
    top left corner: oldX=10 oldY=10
    newX = a * oldX + c * oldY + e = 3 * 10 - 1 * 10 + 30 = 50
    newY = b * oldX + d * oldY + f = 1 * 10 + 3 * 10 + 40 = 80
  
    top right corner: oldX=40 oldY=10
    newX = a * oldX + c * oldY + e = 3 * 40 - 1 * 10 + 30 = 140
    newY = b * oldX + d * oldY + f = 1 * 40 + 3 * 10 + 40 = 110
  
    bottom left corner: oldX=10 oldY=30
    newX = a * oldX + c * oldY + e = 3 * 10 - 1 * 30 + 30 = 30
    newY = b * oldX + d * oldY + f = 1 * 10 + 3 * 30 + 40 = 140
  
    bottom right corner: oldX=40 oldY=30
    newX = a * oldX + c * oldY + e = 3 * 40 - 1 * 30 + 30 = 120
    newY = b * oldX + d * oldY + f = 1 * 40 + 3 * 30 + 40 = 170
    -->
<defs>
<g id="r2">
    <rect id="r2" x="0" y="0" width="300" height="200" fill="silver"/>
    <text x="0" y="200" fill="black" font-size="200">TEST</text>
    <circle cx="0" cy="0" r="30" stroke="yellow" fill="rgba(255,100,100,0.3)" stroke-width="1" />
</g>
</defs>
 <!--<rect x="10" y="10" width="30" height="20" fill="green" />

<rect id="r1" x="10" y="10" width="30" height="20" fill="red"
          transform="matrix(3 1 -1 3 30 40)" />
-->   
<use href="#r2" id="r" />
<use href="#r2" id="r3" />
  </svg>
  </body>
  </html>