<!DOCTYPE HTML>
<html lang="en_US">
<head>
<meta charset="utf-8">
<meta base="http://hom1:8080/" />
<title>Participants</title>

<link rel="stylesheet" type="text/css" media="all" href="http://github.semitasker.com/css/log.css">
<link rel="stylesheet" type="text/css" media="all" href="http://github.semitasker.com/js/jQuery.UI.Combined.1.8.20.1/Content/Content/themes/base/jquery.ui.all.css">
<link rel="stylesheet" type="text/css" media="all" href="http://github.semitasker.com/css/logo-maker-1.css">
<link rel="stylesheet" type="text/css" media="all" href="http://github.semitasker.com/css/green-form.css" >

<style type="text/css">

body {
    font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
}

/* override #panel  styles */
#panel fieldset {
    width: 400px;
}

#panel input,
#panel input[type="range"] {
    display: inline-block;
    width: 196px;
    height: 1.7em;
}

#panel li.expand span {
    display: inline-block;
    width: 4em;
    text-align: right;
}

#panel select {
    width: 200px;
}
</style>

<script type="text/javascript" src="https://d3js.org/d3.v4.js"></script>
<script type="text/javascript" src="http://github.semitasker.com/js/jquery-1.7.1.js"></script>
<script type="text/javascript" src="http://github.semitasker.com/js/jQuery.UI.Combined.1.8.20.1/Content/Scripts/jquery-ui-1.8.20.js"></script>
<script type="text/javascript" src="http://github.semitasker.com/js/log-2.js"></script>
<script type="text/javascript" src="http://github.semitasker.com/js/data.js"></script>
<script type="text/javascript" src="http://github.semitasker.com/js/form-save-restore.js"></script>
<script type="text/javascript" src="http://github.semitasker.com/js/binary-hex-conversions.js"></script>
<script type="text/javascript" src="http://github.semitasker.com/js/example-library.js"></script>
<script type="text/javascript" src="http://github.semitasker.com/js/svg-transform.js"></script>
<script type="text/javascript" src="load.js"></script>

<script>


var Customer = {
    configureSearchField: function (selectId) {
        fieldToSearch = $('#' + selectId + ' option:selected').val();
        Data.saveSelect(selectId,'Customer.restoreSearchField');
    },
    restoreSearchField: function (selectId) {
        Data.restoreSelect(selectId);
        fieldToSearch = $('#' + selectId + ' option:selected').val();
    },
    configureSearchList: function (selectId) {
        searchListName = $('#' + selectId + ' option:selected').val();
        tmpSearchList = searchLists[searchListName].list;
        Data.saveSelect(selectId,'Customer.restoreSearchList');
    },
    restoreSearchList: function (selectId) {
        Data.restoreSelect(selectId);
        searchListName = $('#' + selectId + ' option:selected').val();
        tmpSearchList = searchLists[searchListName].list;
    },
    restore: function (inputId) {
        Data.restoreInput(inputId);
        var searchString = $('#' + inputId).val();
        searchLength = searchString.length;
    },
    search: function (inputId, outputSelector) {
        evt = event;
        var searchString = $('#' + inputId).val();
        var searchRegExp = new RegExp(searchString,"i");
 
        if (tmpSearchList.length == 0) {
            tmpSearchList = searchLists[searchList].list;   
        }
        if (evt.key == "Backspace") {
            tmpSearchList = searchLists[searchList].list;
        }
        if (searchString.length <= searchLength) {
            tmpSearchList = searchLists[searchList].list;
        }
        
        searchLength = searchString.length;
        var match = [];
        var tmpTmpSearchList = [];
        for (var i = 0;i<tmpSearchList.length;i++) {
            customer = tmpSearchList[i];
            match = customer[fieldToSearch].match(searchRegExp);
            if (match) {
                tmpTmpSearchList.push(customer);
            }
        }
        if (tmpTmpSearchList.length > 0) {
            tmpSearchList = tmpTmpSearchList;
            $(outputSelector).html('');
            for (var i = 0;i<tmpSearchList.length;i++) {
                customer = tmpSearchList[i];
                $(outputSelector).append('<li>' + customer.name + '</li>\n');
            }
            Data.saveInput(inputId,'Customer.restore');
        } else {
            // restore previous search term
            if (evt.key == "Backspace") return;
            var newSearchString = searchString.substring(0,searchString.length-1)
            $('#' + inputId).val(newSearchString);
            searchLength = newSearchString.length;
        }
    }
    
};



$(document).ready(function() {

    console.log("Starting to get data");
    loadIntuitInterchangeFormatFile("all-customer-data-2016-09-18-1");
    Data.restoreSelect('fieldToSearch');
    
});



</script>

</head>
<body>

<form id="panel" onSubmit="javascript:return false">
<fieldset>
<legend>Participant Search</legend>
<ul>
 <li><label for="fieldToSearch">Search Field:</label>
 <select id="fieldToSearch"
  onChange="Customer.configureSearchField('fieldToSearch')">
   <option value="search">All Fields</option>
   <option value="name">Name</option>
   <option value="doc">DOC #</option>
   <option value="cco">CCO</option>
   <option value="house">House</option>
  </select>
  </li>
 <li><label for="searchList">List:</label>
 <select id="searchList" name="searchList"
  onChange="Customer.configureSearchList('searchList')">
   <option value="active" selected="selected">Active</option>
   <option value="all">All</option>
   <option value="leaders">House Leaders</option>
   <option value="terminated">Terminated</option>
   <option value="left">Left Program</option>
  </select>
  </li>
  <li><label for="searchTerms">Search For:</label>
  <input type="text" id="searchTerms" name="searchTerms"
   onKeyUp="Customer.search('searchTerms','#selection');" />
 </ul>
 </fieldset>

</form>
<div id="selection"></div>

</body>
</html>
