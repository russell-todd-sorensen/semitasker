<html><head>
<title>ns_conn - NaviServer Built-in Commands </title>
<link rel="stylesheet" href=".././nsd.css" type="text/css">
</head>
<! -- Generated from file 'files/ns_conn.html' by tcllib/doctools with format 'html'
   -->
<! -- CVS: $Id$ ns_conn.n
   -->

<body>
<hr> [
  <a href=".././toc.html">Table Of Contents</a>
| <a href=".././index.html">Keyword Index</a>
] <hr>

<h1> ns_conn(n) 4.99  &quot;NaviServer Built-in Commands&quot;</h1>
<h2><a name="name">NAME</a></h2>
<p>
<p> ns_conn - Find information about the current HTTP connection




<h2><a name="table_of_contents">TABLE OF CONTENTS</a></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#table_of_contents">TABLE OF CONTENTS</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#synopsis">SYNOPSIS</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#description">DESCRIPTION</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#commands">COMMANDS</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#examples">EXAMPLES</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#keywords">KEYWORDS</a><br>
<h2><a name="synopsis">SYNOPSIS</a></h2>
<p>
<table border=1 width=100% cellspacing=0 cellpadding=0><tr            bgcolor=lightyellow><td bgcolor=lightyellow><table 0 width=100% cellspacing=0 cellpadding=0><tr valign=top ><td ><a href="#1"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>option</i> ?<i class='arg'>arg arg ...</i>?</a></td></tr>
<tr valign=top ><td ><a href="#2"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>authpassword</i></a></td></tr>
<tr valign=top ><td ><a href="#3"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>authuser</i></a></td></tr>
<tr valign=top ><td ><a href="#4"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>close</i></a></td></tr>
<tr valign=top ><td ><a href="#5"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>content</i> ?<i class='arg'>offset</i>? ?<i class='arg'>length</i>?</a></td></tr>
<tr valign=top ><td ><a href="#6"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>contentlength</i></a></td></tr>
<tr valign=top ><td ><a href="#7"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>copy</i> <i class='arg'>off</i> <i class='arg'>len</i> <i class='arg'>chan</i></a></td></tr>
<tr valign=top ><td ><a href="#8"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>driver</i></a></td></tr>
<tr valign=top ><td ><a href="#9"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>form</i></a></td></tr>
<tr valign=top ><td ><a href="#10"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>headers</i></a></td></tr>
<tr valign=top ><td ><a href="#11"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>host</i></a></td></tr>
<tr valign=top ><td ><a href="#12"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>isconnected</i></a></td></tr>
<tr valign=top ><td ><a href="#13"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>location</i></a></td></tr>
<tr valign=top ><td ><a href="#14"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>method</i></a></td></tr>
<tr valign=top ><td ><a href="#15"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>outputheaders</i></a></td></tr>
<tr valign=top ><td ><a href="#16"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>peeraddr</i></a></td></tr>
<tr valign=top ><td ><a href="#17"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>port</i></a></td></tr>
<tr valign=top ><td ><a href="#18"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>protocol</i></a></td></tr>
<tr valign=top ><td ><a href="#19"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>query</i></a></td></tr>
<tr valign=top ><td ><a href="#20"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>request</i></a></td></tr>
<tr valign=top ><td ><a href="#21"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>start</i></a></td></tr>
<tr valign=top ><td ><a href="#22"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>url</i></a></td></tr>
<tr valign=top ><td ><a href="#23"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>urlc</i></a></td></tr>
<tr valign=top ><td ><a href="#24"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>urlv</i></a></td></tr>
<tr valign=top ><td ><a href="#25"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>version</i></a></td></tr>
</table></td></tr></table>
<h2><a name="description">DESCRIPTION</a></h2>
<p>

This command is used to retrieve various pieces of information about a connection.

<h2><a name="commands">COMMANDS</a></h2>
<p>

<dl>

<dt><a name="1"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>option</i> ?<i class='arg'>arg arg ...</i>?</a><dd>


</dl>

<dl>


<dt><a name="2"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>authpassword</i></a><dd>


Returns the decoded user password from the authorization data.

<br><br>
<dt><a name="3"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>authuser</i></a><dd>


Returns the decoded user name from the authorization data.

<br><br>
<dt><a name="4"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>close</i></a><dd>


Closes the connection so the script (or ADP) can do any time-consuming processing
without making the client wait. If you use ns_conn close in an ADP, streaming
should be turned on before closing the connection (i.e. &lt;SCRIPT RUNAT=SERVER STREAM=ON&gt;)
or nothing will get sent out at all.

<br><br>
<dt><a name="5"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>content</i> ?<i class='arg'>offset</i>? ?<i class='arg'>length</i>?</a><dd>


Returns the content of the HTTP request body, optionally a substring of that content
starting at offset and extending length characters.

<br><br>
<dt><a name="6"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>contentlength</i></a><dd>


Returns the number of bytes in the content passed in.

<br><br>
<dt><a name="7"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>copy</i> <i class='arg'>off</i> <i class='arg'>len</i> <i class='arg'>chan</i></a><dd>


Copies data from the current connection to chan starting at byte off for len bytes.

<br><br>
<dt><a name="8"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>driver</i></a><dd>


Returns the name of the module (nssock or nsssl) that is acting as the
communications driver for this connection.

<br><br>
<dt><a name="9"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>form</i></a><dd>


Returns any submitted form data as an ns_set. This form data may have been submitted
with a POST or appended to the URL in a GET request. Note: ns_conn form is not suitable
for multipart formdata file upload widgets.

<br><br>
<dt><a name="10"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>headers</i></a><dd>


Returns all the header data as an ns_set. The keys of the ns_set represent the field
names. The case of the returned field names depends on the HeaderCase configuration
parameter. By default, HeaderCase is &quot;Preserve&quot;, which means case is preserved.

<br><br>
<dt><a name="11"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>host</i></a><dd>


Returns the host part of the URL in the HTTP request.

<br><br>
<dt><a name="12"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>isconnected</i></a><dd>


Returns 1 if you're in a connection thread, and you are therefore allowed to make
calls to ns_conn. It returns 0 if you're not in a connection thread (such as when
you're in a schedule procedure) and you are not allowed to make calls to ns_conn.

<br><br>
<dt><a name="13"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>location</i></a><dd>


Returns the location string for this virtual server in the form: protocol://hostname[:port].

<br><br>
<dt><a name="14"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>method</i></a><dd>


Returns the HTTP method, e.g. GET.

<br><br>
<dt><a name="15"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>outputheaders</i></a><dd>


Returns an ns_set containing the headers that will be sent out when a result is returned
to the client. This ns_set can be manipulated like any other ns_set. You can also use this
command to write to the set of output headers. For example: ns_set put [ns_conn outputheaders] key value.

<br><br>
<dt><a name="16"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>peeraddr</i></a><dd>


Returns the IP address of the client, i.e. the &quot;other side&quot; of the HTTP connection. The
IP address is returned in the form of a string separated with periods (e.g., 155.164.59.75).

<br><br>
<dt><a name="17"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>port</i></a><dd>


Returns the port specified explicitly in the URL of the HTTP request. If the browser does
not explicity send the &quot;:port&quot; part of the URL, the port number returned will be 0.

<br><br>
<dt><a name="18"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>protocol</i></a><dd>


Returns the protocol of the URL in the HTTP request (usually unspecified).

<br><br>
<dt><a name="19"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>query</i></a><dd>


Returns any query data that was part of the HTTP request.

<br><br>
<dt><a name="20"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>request</i></a><dd>


Returns the HTTP request line as presented by the client, e.g. GET / HTTP/1.1.

<br><br>
<dt><a name="21"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>start</i></a><dd>


Returns the time the connection request started in &quot;sec:usec&quot; (aka ns_time) format.

<br><br>
<dt><a name="22"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>url</i></a><dd>


Returns the URL of the HTTP request. This is the portion of the request after the
hostname, for example [ns_conn url] on  returns /index.adp.

<br><br>
<dt><a name="23"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>urlc</i></a><dd>


Returns the number of elements (delimited by `/') in the URL of the HTTP request.

<br><br>
<dt><a name="24"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>urlv</i></a><dd>


 Returns a list containing the pieces of the URL delimited by `/'.

<br><br>
<dt><a name="25"><b class='cmd'><a href="ns_conn.html"> ns_conn </a></b> <i class='arg'>version</i></a><dd>


Returns the version of the HTTP request. This is usually 1.0 or 1.1.

</dl>

<h2><a name="examples">EXAMPLES</a></h2>
<p>

<p><table><tr><td bgcolor=black>&nbsp;</td><td><pre class='sample'>

if { [string match /page/* [ns_conn url]] } {
  ns_returnnotfound
}

</pre></td></tr></table></p>



<h2><a name="keywords">KEYWORDS</a></h2>
<p>
<a href="../index.html#key571"> ns_getform </a>, <a href="../index.html#key46"> ns_queryget </a>, <a href="../index.html#key83"> ns_time </a>
</body></html>

